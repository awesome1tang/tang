!function(e,t){function n(e,t,n){var r=e.children(),i=!1;e.empty();for(var o=0,u=r.length;o<u;o++){var a=r.eq(o);if(e.append(a),n&&e.append(n),s(e,t)){a.remove(),i=!0;break}n&&n.detach()}return i}function r(t,n,o,u,a){var f=!1,l="a, table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",c="script, .dotdotdot-keep";return t.contents().detach().each(function(){var h=this,p=e(h);if("undefined"==typeof h)return!0;if(p.is(c))t.append(p);else{if(f)return!0;t.append(p),!a||p.is(u.after)||p.find(u.after).length||t[t.is(l)?"after":"append"](a),s(o,u)&&(f=3==h.nodeType?i(p,n,o,u,a):r(p,n,o,u,a)),f||a&&a.detach()}}),n.addClass("is-truncated"),f}function i(t,n,r,i,u){var l=t[0];if(!l)return!1;var h=f(l),p=h.indexOf(" ")!==-1?" ":"　",d="letter"==i.wrap?"":p,v=h.split(d),m=-1,g=-1,y=0,b=v.length-1;if(i.fallbackToLetter&&0===y&&0===b&&(d="",v=h.split(d),b=v.length-1),i.maxLength)h=o(h.trim().substr(0,i.maxLength),i),a(l,h);else{for(;y<=b&&(0!==y||0!==b);){var w=Math.floor((y+b)/2);if(w==g)break;g=w,a(l,v.slice(0,g+1).join(d)+i.ellipsis),r.children().each(function(){e(this).toggle().toggle()}),s(r,i)?(b=g,i.fallbackToLetter&&0===y&&0===b&&(d="",v=v[0].split(d),m=-1,g=-1,y=0,b=v.length-1)):(m=g,y=g)}if(m==-1||1===v.length&&0===v[0].length){var E=t.parent();t.detach();var S=u&&u.closest(E).length?u.length:0;if(E.contents().length>S?l=c(E.contents().eq(-1-S),n):(l=c(E,n,!0),S||E.detach()),l&&(h=o(f(l),i),a(l,h),S&&u)){var x=u.parent();e(l).parent().append(u),e.trim(x.html())||x.remove()}}else h=o(v.slice(0,m+1).join(d),i),a(l,h)}return!0}function s(e,t){return e.innerHeight()>t.maxHeight||t.maxLength&&e.text().trim().length>t.maxLength}function o(t,n){for(;e.inArray(t.slice(-1),n.lastCharacter.remove)>-1;)t=t.slice(0,-1);return e.inArray(t.slice(-1),n.lastCharacter.noEllipsis)<0&&(t+=n.ellipsis),t}function u(e){return{width:e.innerWidth(),height:e.innerHeight()}}function a(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function f(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function l(e){do e=e.previousSibling;while(e&&1!==e.nodeType&&3!==e.nodeType);return e}function c(t,n,r){var i,s=t&&t[0];if(s){if(!r){if(3===s.nodeType)return s;if(e.trim(t.text()))return c(t.contents().last(),n)}for(i=l(s);!i;){if(t=t.parent(),t.is(n)||!t.length)return!1;i=l(t[0])}if(i)return c(e(i),n)}return!1}function h(t,n){return!!t&&("string"==typeof t?(t=e(t,n),!!t.length&&t):!!t.jquery&&t)}function p(e){for(var t=e.innerHeight(),n=["paddingTop","paddingBottom"],r=0,i=n.length;r<i;r++){var s=parseInt(e.css(n[r]),10);isNaN(s)&&(s=0),t-=s}return t}if(!e.fn.dotdotdot){e.fn.dotdotdot=function(t){if(0===this.length)return e.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){e(this).dotdotdot(t)});var i=this,o=i.contents();i.data("dotdotdot")&&i.trigger("destroy.dot"),i.data("dotdotdot-style",i.attr("style")||""),i.css("word-wrap","break-word"),"nowrap"===i.css("white-space")&&i.css("white-space","normal"),i.bind_events=function(){return i.bind("update.dot",function(t,u){switch(i.removeClass("is-truncated"),t.preventDefault(),t.stopPropagation(),typeof a.height){case"number":a.maxHeight=a.height;break;case"function":a.maxHeight=a.height.call(i[0]);break;default:a.maxHeight=p(i)}a.maxHeight+=a.tolerance,"undefined"!=typeof u&&(("string"==typeof u||"nodeType"in u&&1===u.nodeType)&&(u=e("<div />").append(u).contents()),u instanceof e&&(o=u)),v=i.wrapInner('<div class="dotdotdot" />').children(),v.contents().detach().end().append(o.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var l=!1,c=!1;return f.afterElement&&(l=f.afterElement.clone(!0),l.show(),f.afterElement.detach()),s(v,a)&&(c="children"==a.wrap?n(v,a,l):r(v,i,v,a,l)),v.replaceWith(v.contents()),v=null,e.isFunction(a.callback)&&a.callback.call(i[0],c,o),f.isTruncated=c,c}).bind("isTruncated.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(i[0],f.isTruncated),f.isTruncated}).bind("originalContent.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),"function"==typeof t&&t.call(i[0],o),o}).bind("destroy.dot",function(e){e.preventDefault(),e.stopPropagation(),i.unwatch().unbind_events().contents().detach().end().append(o).attr("style",i.data("dotdotdot-style")||"").removeClass("is-truncated").data("dotdotdot",!1)}),i},i.unbind_events=function(){return i.unbind(".dot"),i},i.watch=function(){if(i.unwatch(),"window"==a.watch){var t=e(window),n=t.width(),r=t.height();t.bind("resize.dot"+f.dotId,function(){n==t.width()&&r==t.height()&&a.windowResizeFix||(n=t.width(),r=t.height(),c&&clearInterval(c),c=setTimeout(function(){i.trigger("update.dot")},100))})}else l=u(i),c=setInterval(function(){if(i.is(":visible")){var e=u(i);l.width==e.width&&l.height==e.height||(i.trigger("update.dot"),l=e)}},500);return i},i.unwatch=function(){return e(window).unbind("resize.dot"+f.dotId),c&&clearInterval(c),i};var a=e.extend(!0,{},e.fn.dotdotdot.defaults,t),f={},l={},c=null,v=null;return a.lastCharacter.remove instanceof Array||(a.lastCharacter.remove=e.fn.dotdotdot.defaultArrays.lastCharacter.remove),a.lastCharacter.noEllipsis instanceof Array||(a.lastCharacter.noEllipsis=e.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),f.afterElement=h(a.after,i),f.isTruncated=!1,f.dotId=d++,i.data("dotdotdot",!0).bind_events().trigger("update.dot"),a.watch&&i.watch(),i},e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,maxLength:null},e.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},e.fn.dotdotdot.debug=function(e){};var d=1,v=e.fn.html;e.fn.html=function(n){return n!=t&&!e.isFunction(n)&&this.data("dotdotdot")?this.trigger("update",[n]):v.apply(this,arguments)};var m=e.fn.text;e.fn.text=function(n){return n!=t&&!e.isFunction(n)&&this.data("dotdotdot")?(n=e("<div />").text(n).html(),this.trigger("update",[n])):m.apply(this,arguments)}}}(jQuery),jQuery(document).ready(function(e){e(".dot-ellipsis").each(function(){var n=e(this).hasClass("dot-resize-update"),r=e(this).hasClass("dot-timer-update"),i=0,s=e(this).attr("class").split(/\s+/);e.each(s,function(e,t){var n=t.match(/^dot-height-(\d+)$/);null!==n&&(i=Number(n[1]))});var o={};r&&(o.watch=!0),n&&(o.watch="window"),i>0&&(o.height=i),e(this).dotdotdot(o)})}),jQuery(window).on("load",function(){jQuery(".dot-ellipsis.dot-load-update").trigger("update.dot")}),define("dotdotdot",function(){}),function(e){e.fn.extend({PopupDialog:function(t){var n={popupClass:"",maskLayer:!0,delayClose:null,callback:function(){},cancelCallback:function(){}},t=e.extend(!0,n,t);return this.each(function(){var n=e(this),r=e(t.popupClass).outerWidth(),i=e(t.popupClass).outerHeight(),s=e(window).scrollTop(),o=e(window).height(),u=e(document).height(),a,f={init:function(){var n=(o-i)/2+s,u=n<s?s:n;e(t.popupClass).css({marginLeft:-(r/2),top:u,display:"block"}),e(".pop_close",t.popupClass).unbind("click").bind("click",function(){f.layerClose(),t.cancelCallback()}),window.popupCancelCallback=t.cancelCallback,e(".cancel",t.popupClass).bind("click",function(){t.cancelCallback()}),e(".confirm",t.popupClass).bind("click",function(){t.callback()}),t.maskLayer&&f.maskModel(),t.delayClose!=null&&f.delayModel()},maskModel:function(){e(t.popupClass).after("<div class='popup_mask'></div>"),e(".popup_mask").css("height",u),/msie\s+[5-6]\./i.test(window.navigator.userAgent)&&(e(".popup_mask").after("<iframe class='popup_iframe' frameborder='0'></iframe>"),e(".popup_iframe").css("height",u))},layerClose:function(){window.clearInterval(a),e(t.popupClass).hide(),e(".popup_mask").remove(),e(".popup_iframe").remove()},delayModel:function(){e(".delayClose",t.popupClass).text(t.delayClose);var n=t.delayClose;a=setInterval(function(){n==1?(window.clearInterval(a),f.layerClose()):(n--,e(".delayClose",t.popupClass).text(n))},1e3)}};f.init()}),this}})}(jQuery),define("dialog",function(){}),function(e){e.fn.extend({scrollPlugin:function(t){var n={prevClassName:".left_arrow",nextClassName:".right_arrow",disableClass:"unable",disableStyle:{opacity:".2",cursor:"default"},slideClassName:".sale_scroll_ul",distance:"screen",viewDot:"false",showItem:"",speed:400,callBack:function(){}},t=e.extend(!0,n,t);return this.each(function(){var n=e(this),r=e(t.prevClassName,n),i=e(t.nextClassName,n),s=e(t.slideClassName,n),o=s.find("li").length,u=s.find("li").outerWidth(!0),a,f,l=0,c,h=t.showItem?t.showItem:Math.round(n.width()/u);switch(t.distance){case"single":a=u,f=o-h;break;case"screen":a=u*h,f=Math.ceil(o/h)-1}if(f<=0)return r.hide(),i.hide(),!1;var p={init:function(){s.css({width:u*o}),r.addClass(t.disableClass).unbind("click").bind("click",p.rightScroll),i.unbind("click").bind("click",p.leftScroll),p.dotViewEvent(),t.callBack()},leftScroll:function(){s.is(":animated")||(l+=1,l==f+1?l=f:"",l==f?p.toLastPage():p.showPlay("-",a),r.removeClass(t.disableClass),p.dotHighlight())},rightScroll:function(){s.is(":animated")||(l-=1,l==-1?l=0:"",l==0?p.toFirstPage():p.showPlay("+",a),i.removeClass(t.disableClass),p.dotHighlight())},showPlay:function(e,n){s.stop(!0,!0).animate({marginLeft:""+e+"="+n},t.speed)},toLastPage:function(){i.addClass(t.disableClass),r.removeClass(t.disableClass),s.stop(!0,!0).animate({marginLeft:-(o-h)*u},t.speed)},toFirstPage:function(){r.addClass(t.disableClass),i.removeClass(t.disableClass),s.stop(!0,!0).animate({marginLeft:0},t.speed)},renderDotView:function(){var e=n.find(".view_dot"),t='<div class="view_dot"><span class="cur"></span>';e.length&&e.remove();for(var r=0;r<f;r++)t+="<span></span>";t+="</div>",n.append(t)},dotViewEvent:function(){t.viewDot=="dot"&&(p.renderDotView(),c=n.find(".view_dot").children("span"),c.unbind("click").bind("click",function(){var s=e(this),o=n.find(".cur").index();l=s.index(),s.addClass("cur").siblings().removeClass("cur"),l==f?p.toLastPage():l==0?p.toFirstPage():(i.removeClass(t.disableClass),r.removeClass(t.disableClass),l>o?p.showPlay("-",(l-o)*a):p.showPlay("+",(o-l)*a))}))},dotHighlight:function(){t.viewDot=="dot"&&(c=n.find(".view_dot").children("span"),c.eq(l).addClass("cur").siblings().removeClass("cur"))}};p.init()}),this}})}(jQuery),define("scroll",function(){});var funParabola=function(e,t,n){var r={speed:166.67,curvature:.001,progress:function(){},complete:function(){}},i={};n=n||{};for(var s in r)i[s]=n[s]||r[s];var o={mark:function(){return this},position:function(){return this},move:function(){return this},init:function(){return this}},u="margin",a=document.createElement("div");"oninput"in a&&["","ms","webkit"].forEach(function(e){var t=e+(e?"T":"t")+"ransform";t in a.style&&(u=t)});var f=i.curvature,l=0,c=0,h=!0;if(e&&t&&e.nodeType==1&&t.nodeType==1){var p={},d={},v={},m={},g={},y={};o.mark=function(){return h==0?this:(typeof g.x=="undefined"&&this.position(),e.setAttribute("data-center",[g.x,g.y].join()),t.setAttribute("data-center",[y.x,y.y].join()),this)},o.position=function(){if(h==0)return this;var n=document.documentElement.scrollLeft||document.body.scrollLeft,r=document.documentElement.scrollTop||document.body.scrollTop;return u=="margin"?e.style.marginLeft=e.style.marginTop="0px":e.style[u]="translate(0, 0)",p=e.getBoundingClientRect(),d=t.getBoundingClientRect(),v={x:p.left+(p.right-p.left)/2+n,y:p.top+(p.bottom-p.top)/2+r},m={x:d.left+(d.right-d.left)/2+n,y:d.top+(d.bottom-d.top)/2+r},g={x:0,y:0},y={x:-1*(v.x-m.x),y:-1*(v.y-m.y)},l=(y.y-f*y.x*y.x)/y.x,this},o.move=function(){if(h==0)return this;var t=0,n=y.x>0?1:-1,r=function(){var s=2*f*t+l;t+=n*Math.sqrt(i.speed/(s*s+1));if(n==1&&t>y.x||n==-1&&t<y.x)t=y.x;var o=t,a=f*o*o+l*o;e.setAttribute("data-center",[Math.round(o),Math.round(a)].join()),u=="margin"?(e.style.marginLeft=o+"px",e.style.marginTop=a+"px"):e.style[u]="translate("+[o+"px",a+"px"].join()+")",t!==y.x?(i.progress(o,a),window.requestAnimationFrame(r)):(i.complete(),h=!0)};return window.requestAnimationFrame(r),h=!1,this},o.init=function(){this.position().mark().move()}}return o};(function(){var e=0,t=["webkit","moz"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16.7-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),define("parabola",function(){}),function(){function resolveDefs(e,t,n){return(typeof t=="string"?t:t.toString()).replace(e.define||skip,function(t,r,i,s){return r.indexOf("def.")===0&&(r=r.substring(4)),r in n||(i===":"?(e.defineParams&&s.replace(e.defineParams,function(e,t,i){n[r]={arg:t,text:i}}),r in n||(n[r]=s)):(new Function("def","def['"+r+"']="+s))(n)),""}).replace(e.use||skip,function(t,r){e.useParams&&(r=r.replace(e.useParams,function(e,t,r,i){if(n[r]&&n[r].arg&&i){var s=(r+":"+i).replace(/'|\\/g,"_");return n.__exp=n.__exp||{},n.__exp[s]=n[r].text.replace(new RegExp("(^|[^\\w$])"+n[r].arg+"([^\\w$])","g"),"$1"+i+"$2"),t+"def.__exp['"+s+"']"}}));var i=(new Function("def","return "+r))(n);return i?resolveDefs(e,i,n):i})}function unescape(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var doT={version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:undefined,compile:undefined,log:!0},_globals;doT.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(n,function(e){return t[e]||e}):""}},_globals=function(){return this||(0,eval)("this")}(),typeof module!="undefined"&&module.exports?module.exports=doT:typeof define=="function"&&define.amd?define("doT",[],function(){return doT}):_globals.doT=doT;var startend={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},skip=/$^/;doT.template=function(e,t,n){t=t||doT.templateSettings;var r=t.append?startend.append:startend.split,i,s=0,o,u=t.use||t.define?resolveDefs(t,e,n||{}):e;u=("var out='"+(t.strip?u.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):u).replace(/'|\\/g,"\\$&").replace(t.interpolate||skip,function(e,t){return r.start+unescape(t)+r.end}).replace(t.encode||skip,function(e,t){return i=!0,r.startencode+unescape(t)+r.end}).replace(t.conditional||skip,function(e,t,n){return t?n?"';}else if("+unescape(n)+"){out+='":"';}else{out+='":n?"';if("+unescape(n)+"){out+='":"';}out+='"}).replace(t.iterate||skip,function(e,t,n,r){return t?(s+=1,o=r||"i"+s,t=unescape(t),"';var arr"+s+"="+t+";if(arr"+s+"){var "+n+","+o+"=-1,l"+s+"=arr"+s+".length-1;while("+o+"<l"+s+"){"+n+"=arr"+s+"["+o+"+=1];out+='"):"';} } out+='"}).replace(t.evaluate||skip,function(e,t){return"';"+unescape(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),i&&(!t.selfcontained&&_globals&&!_globals._encodeHTML&&(_globals._encodeHTML=doT.encodeHTMLSource(t.doNotSkipEncoded)),u="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+doT.encodeHTMLSource.toString()+"("+(t.doNotSkipEncoded||"")+"));"+u);try{return new Function(t.varname,u)}catch(a){throw typeof console!="undefined"&&console.log("Could not create a template function: "+u),a}},doT.compile=function(e,t){return doT.template(e,null,t)}}(),define("utils",["jquery","doT"],function(e,t){function i(e){return e&&typeof e=="object"&&Array==e.constructor}Array.prototype.remove=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=e<0?this.length+e:e,this.push.apply(this,n)},Array.prototype.insert=function(e,t){this.splice(e,0,t)},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)(new RegExp("("+n+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Date.prototype.hoursDiff=function(e){return parseInt(Math.abs(this.getTime()-e.getTime())/36e5)};var n={},r=document.location.href;return n.isReqSuccess=function(e){return e&&e.code=="00000000"},n.unique=function(e){var t=[],n={};for(var r=0,i;(i=e[r])!=null;r++)n[i]||(t.push(i),n[i]=!0);return t},n.checkLogin=function(t){if(!t)return!1;var n="https://passport.yhd.com/publicPassport/isLogin.do?callback=?";e.ajax({type:"get",url:n,dataType:"json",success:function(e){if(e.result=="1"){t(!0);return}t(!1)},error:function(){t(!1)}})},window.getTestJson=function(t,n){e.ajax({url:"/statics/testData/"+t,cache:!1,async:!1,type:"GET",dataType:"json",success:function(e){n(e)}})},n.getUserLoggedInPage=function(){return e("#userLoggedInPage").val()},n.getParamStrFromJson=function(e){var t="",n,r;for(var s in e){if(!e[s])continue;e.hasOwnProperty(s)&&(n=s),r=e[s];if(i(r))for(var o=0;o<r.length;o++)t+="&"+n+"="+encodeURIComponent(r[o]);else t+="&"+n+"="+encodeURIComponent(r)}return t.substring(1,t.length)},n.getByteLen=function(t){var n=0;for(var r=0;r<t.length;r++){var i=t.charAt(r);i.match(/[^\x00-\xff]/ig)!=null?n+=2:n+=1}return n},n.getCookie=function(e){var t=document.cookie.split("; ");for(var n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]==e)return unescape(r[1])}},n.zoomImg=function(e,t){if(!e||!t)return e||"//image.yihaodianimg.com/front-homepage/global/images/defaultproduct.jpg";var n=e.lastIndexOf(".",e.lenght-4);return e.substring(0,n)+"_"+t+"x"+t+e.substring(n)},n}),define("newCart",["jquery","dialog","scroll","parabola","utils","doT","require"],function(e,t,n,r,i,s,o){function f(t){function n(){var t=e(".check_item").map(function(){if(e(this).hasClass("checked"))return"1"}).get().join(","),n=i.unique(t.split(","));if(t.length>0||n.length>1){var r=e(".check_item.checked"),s=e(".check_item.checked.oversea"),o=e(".check_item.checked:not(.oversea)"),u=[];if(s.length==0||s.length==r.length)u=r,l(u,[]);else{var a=0,f=0;e(s).each(function(){return a=parseInt(a)+parseInt(e(this).siblings(".item_num").find("input[class='input']").val()),a}),e(o).each(function(){return f=parseInt(f)+parseInt(e(this).siblings(".item_num").find("input[class='input']").val()),f}),e(".oversea_icon").find("span").html("海购商品（"+a+"）件"),e(".normal_icon").find("span").html("普通商品（"+f+"）件"),e(this).PopupDialog({popupClass:".split_payfor_pop",delayClose:null,maskLayer:!0}),e("body").on("click",".split_payfor_pop li",function(){e(this).addClass("v_choose").siblings("li").removeClass("v_choose")});var c=[];e(".confirm.pop_close.oversea").on("click",function(){e(".oversea_icon").hasClass("v_choose")&&(c=o,u=s),e(".normal_icon").hasClass("v_choose")&&(c=s,u=o),l(u,c)})}}}var r=e(".pay_tools_r .checkout_btn");if(t){var s=e(".check_item").map(function(){if(e(this).hasClass("checked"))return"1"}).get().join(",");s&&s.length>0?(r.removeClass("unable"),r.off().on("click",n)):r.addClass("unable")}else r.addClass("unable"),r.unbind("click")}function l(t,n){if(!p("0"))return;var r=e(t).map(function(){if(e(this).parents(".cart_prod").hasClass("unable")){var t=e(this).siblings(".item_pic").find("img").attr("src")||e(this).siblings(".item_pic").find("img").data("url");return'<li class = clearfix><div class = nu_pic><a><img src="'+t+"\" width='50' height='50'></a></div><div class = nu_txt><a>"+e(this).siblings(".item_tit").text()+"</a></div></li>"}}).get().join("");e(".null_payfor_pop").find(".npay_ulbox").html(r);if(r.length>0)e(this).PopupDialog({popupClass:".null_payfor_pop",delayClose:null,maskLayer:!0}),e(".confirm.pop_close.no_stock").on("click",function(){var r=0,i=e(t).map(function(){if(e(this).parents(".cart_prod").hasClass("unable"))return d(this,r++)}).get().join("&");n.length>0&&(i=i+"&"+e(n).map(function(){return d(this,r++)}).get().join("&")),v(i),yhdPublicLogin.checkLogin(function(e){e?window.location.href="//trade.yhd.com/shopping/order/getOrderInfo.do":yhdPublicLogin.showLoginDivNone(URLPrefix_passport,!1,"",c,2)})});else{if(n.length>0){var i=0,s=e(n).map(function(){return d(this,i++)}).get().join("&");v(s)}yhdPublicLogin.checkLogin(function(e){e?window.totalNeedGold>0?(h(),p("0")&&(window.location.href="//trade.yhd.com/shopping/order/getOrderInfo.do")):window.location.href="//trade.yhd.com/shopping/order/getOrderInfo.do":yhdPublicLogin.showLoginDivNone(URLPrefix_passport,!1,"",c,2)})}}function c(){window.totalNeedGold>0?(h(),p("1")&&(window.location.href="/cart/mod/mergeCart.do")):window.location.href="/cart/mod/mergeCart.do"}function h(){e.ajax({url:"/cart/opt/queryUserGoldNum.do",data:{},async:!1,jsonpCallback:"jQuery"+e.now(),type:"get",dataType:"jsonp",error:function(){window.userGoldNum=0},success:function(e){window.userGoldNum=e.data.data}})}function p(e){var t=window.totalNeedGold,n=window.userGoldNum;return t>0&&t>n?(u.dialog({tit:"disabled",cancel:"disabled",txt:"当前金币余额为（"+n+"），不足购买金币商品哦~",callback:function(){e=="1"&&(window.location.href="/cart/cart.do")}}),!1):!0}function d(t,n){var r=e(t).parents(".main_item").data("identifier");t=window.itemData[r];var i=t.itemType==4?t.promotionId:t.sku.id,s=t.itemType,o=t.promotionId?t.promotionId:0,u="skuItems["+n+"]";return u+".itemId="+i+"&"+u+".itemType="+s+"&"+u+".targetId="+o}function v(t){var n="/cart/opt/uncheckItems.do?"+t+"&callback=?";e.ajax({url:n,dataType:"json",async:!1,success:function(e){return"success"}})}var u={};u.cart_province_id="",u.cart_province_name="",u.cart_city_id="",u.cart_city_name="",u.cart_county_id="",u.cart_county_name="",u.oldProvinceId="";var a="";return u.initClass=function(){function t(){e(".pay_tools_bar").removeClass("tools_bar_bottom tools_bar_top"),u.columnBar()}function n(){e(".cart_item").each(function(){var t=e(this).find("li").find(".l2"),n=e(this).find("li").last(),r=n.find(".l2");n.find(".group_detail").length>0&&r.is(":visible")?r.slideDown():(t.show(),r.slideUp())}),e(".cart_list").each(function(){e(this).find(".cart_item").length==0&&e(this).hide()})}t(),n()},u.areaInit=function(){cart_province_id=e("#cart_province_id").val();if(typeof cart_province_id=="undefined")return!1;cart_province_name=e("#cart_province_name").val().replace("<i></i>",""),cart_city_id=e("#cart_city_id").val(),cart_city_name=e("#cart_city_name").val().replace("<i></i>",""),cart_county_id=e("#cart_county_id").val(),cart_county_name=e("#cart_county_name").val().replace("<i></i>","");var t=cart_province_id;e('dd[name="cart_province"]').each(function(){e(this).attr("value")==cart_province_id?(cart_province_name=e(this).html(),e(this).addClass("on")):e(this).removeClass("on")}),cart_county_name.length>0&&cart_county_name!="0"?e("#detail_area_name").html(cart_province_name+"<i>|</i>"+cart_city_name+"<i>|</i>"+cart_county_name):cart_city_name.length>0?e("#detail_area_name").html(cart_province_name+"<i>|</i>"+cart_city_name):e("#detail_area_name").html(cart_province_name);var n=e(".mod_area_select"),r=n.find(".address"),i=n.find(".tab_box"),s=n.find(".tabs span"),o=n.find(".area_box .item"),u=n.find(".val_text"),f=!1,l=n.offset().top+32;s.eq(0).html("<em>"+cart_province_name+"</em>"),cart_city_name.length>0?s.eq(1).html("<em>"+cart_city_name+"</em>"):(a="请选择市",s.eq(1).html("<em>"+a+"</em>")),cart_county_name.length>0&&cart_county_name!="0"?s.eq(2).html("<em>"+cart_county_name+"</em>"):(countyTip="请选择区",s.eq(2).html("<em>"+countyTip+"</em>"))},u.modAreaSelect=function(){e(".mod_area_select").each(function(){function l(){n.removeClass("select"),r.hide(),t.isOpen=!1,e(t).css({position:"relative",top:0})}function d(t,n){var r,i;if(n==1){e("#cart_county_area").empty();var r="/cart/opt/getCitiesByProvinceId.do?provinceId="+t+"&callback=?";i="cart_city"}else if(n==2){var r="/cart/opt/getCountiesByCityId.do?cityId="+t+"&callback=?";i="cart_county"}else if(n==3){var r="/cart/opt/getTownsByCountyId.do?countyId="+t+"&callback=?";i="cart_county"}e.getJSON(r,null,function(t){if(v(t)){var r="";for(var s=0;s<t.data.length;s++)n==1&&cart_city_id==t.data[s].id||n==2&&cart_county_id==t.data[s].id?r+='<dd value="'+t.data[s].id+'" class="on" data-val="'+t.data[s].name+'" name="'+i+'">'+t.data[s].name+"</dd>":r+='<dd value="'+t.data[s].id+'" data-val="'+t.data[s].name+'" name="'+i+'">'+t.data[s].name+"</dd>";n==1?e("#cart_city_area").html(r):n==2&&e("#cart_county_area").html(r),c(n)}})}function v(e){return e&&e.code=="00000000"}var t=this;t.isOpen=!1;var n=e(this).find(".address"),r=e(this).find(".tab_box"),i=e(this).find(".tabs span"),s=e(this).find(".area_box .item"),u=e(this).find(".val_text"),a=e(this).find(".close"),f={a:i.eq(0).attr("data-val")||"请选择省份",b:i.eq(1).attr("data-val")||"请选择市",c:i.eq(2).attr("data-val")||"请选择区"};n.off().click(function(n){e(this).hasClass("select")?(e(this).removeClass("select"),r.hide(),t.isOpen=!1):(e(this).addClass("select"),r.show(),cart_county_id>0?(d(cart_city_id,2),c(2)):cart_city_id>0?(d(cart_province_id,1),c(1)):c(0),t.isOpen=!0)}),a.click(function(){l()}),e(document).click(function(n){if(!t.isOpen)return;var r=e(n.target);r.parents(".mod_area_select").length==0&&l()}),i.click(function(){var t=e(this).index();t==0?c(0):t==1?d(cart_province_id,1):t==2&&i.eq(1).find("em").html()!="请选择市"&&d(cart_city_id,2)}),e(this).off().click(function(n){var r=e(n.target);if(r.is("dd")){var i=r.parents(".item");if(i.hasClass("first_area")){f.a=r.attr("data-val"),f.b="请选择市",f.c="请选择区";var s=e(r).attr("value");cart_province_id=s,cart_province_name=e(r).html(),c(1),d(s,1)}if(i.hasClass("second_area")){f.b=r.attr("data-val"),f.c="请选择区";var o=e(r).attr("value");cart_city_id=o,cart_city_name=e(r).html(),c(2),d(o,2)}if(i.hasClass("third_area")){f.c=r.attr("data-val");var u=e(r).attr("value");cart_county_id=u,cart_county_name=e(r).html(),h(),e(t).css({position:"relative",top:0}),e(t).find(".address").removeClass("select"),e(t).find(".tab_box").hide()}p(),i.find("dd").removeClass("on"),r.addClass("on")}});var c=function(e,t,n){i.eq(e).addClass("on").siblings().removeClass("on"),s.hide().eq(e).show()},h=function(){n.removeClass("select"),r.hide(),f.a=cart_province_name,f.b=cart_city_name;var t=f.a+"<i>|</i>"+f.b+"<i>|</i>"+f.c;u.html(t),p(),n.removeClass("select"),r.hide();var i=cart_province_id+"_"+cart_city_id+"_"+cart_county_id+"_0";e.cookie("provinceId",cart_province_id,{expires:365,path:"/",domain:".yhd.com"}),e.cookie("cityId",cart_city_id,{expires:365,path:"/",domain:".yhd.com"});var s=e.cookie("yhd_location")||"",a=s.split("_");a.length==4&&(cart_province_id!=a[0]||cart_city_id!=a[1]||cart_county_id!=a[2])&&e.cookie("yhd_coord",null,{path:"/",domain:".yhd.com"}),e.cookie("yhd_location",i,{expires:365,path:"/",domain:".yhd.com"}),e.cookie("ipLoc-djd",i,{expires:365,path:"/",domain:".yhd.com"}),o("cart_main_body").initMainBody(),o("cart_main_body").initPrismBar()},p=function(){i.eq(0).attr("data-val",f.a).find("em").html(f.a),i.eq(1).attr("data-val",f.b).find("em").html(f.b),i.eq(2).attr("data-val",f.c).find("em").html(f.c)}})},u.guessLikeScroll=function(){var t=e(".hot_sale_list");t.scrollPlugin({distance:"screen",viewDot:"dot"})},u.changeBuyScroll=function(){var t=e(".cheap_sale_list");t.scrollPlugin({distance:"screen",viewDot:"dot"})},u.columbBarScroll=function(){var t;e("body").hasClass("w980")?t=[{triggerDom:e(".single_sale_list"),distance:"single",viewDot:"false",showItem:9},{triggerDom:e(".seal_sale_list"),distance:"single",viewDot:"false",showItem:6},{triggerDom:e(".general_sale_list"),distance:"single",viewDot:"false",showItem:6}]:t=[{triggerDom:e(".single_sale_list"),distance:"single",viewDot:"false",showItem:11},{triggerDom:e(".seal_sale_list"),distance:"single",viewDot:"false",showItem:8},{triggerDom:e(".general_sale_list"),distance:"single",viewDot:"false",showItem:8}],e.each(t,function(){this.triggerDom.scrollPlugin({distance:this.distance,viewDot:this.viewDot,showItem:this.showItem})})},u.similarScroll=function(t){var n=e(t);n.scrollPlugin({distance:"screen",viewDot:"dot"})},u.makeupScroll=function(t){var n=e(t),r=n.parents(".cart_shop_list").length!=0||n.hasClass("makeup_list"),i=r?"dot":"false";n.scrollPlugin({distance:"screen",viewDot:i})},u.freeEvents=function(){function r(e){e.addClass("light").siblings().removeClass("light")}var t=e(".free_item"),n=e(".has_free");t.hover(function(){var t=e(this),n=e("#"+t.attr("data-activity"));t.toggleClass("light"),n.hasClass("light")?n.removeClass("light"):r(n)}).on("mouseover",".group_item",function(){e(this).addClass("hover")}).on("mouseout",".group_item",function(){e(this).removeClass("hover")}),n.hover(function(){var t=e(this),n=t.attr("id"),i=e('[data-activity="'+n+'"]');t.toggleClass("light"),i.hasClass("light")?i.removeClass("light"):r(i)})},u.initDialog=function(){function t(){e(".tip_dialog,.dialog").removeClass("slideUp"),e(".pay_tips,.popup_dialog,.makesure_dialog,.pay_tips").hide(),e(".tip_trigger").removeClass("down").parents().removeClass("down");var t=e(".c_global_toolbar"),n=e(".t_warp_slide_tabs .t_control_btn",t),r=e(".t_panel_content",t);t.removeClass("c_toolbar_open"),n.removeClass("t_btn_selected"),r.scrollTop(0)}e(".makeup_prod").hasClass("slideUp")||e(".tip_trigger").removeClass("down").parents().removeClass("down"),t(),e(document).click(function(n){var r=e(n.target);r.closest(".tip_dialog,.dialog,.popup_dialog,.pop_dialog,.pay_tips,.c_global_toolbar,.popup_mask,.checkout_btn,.similar_btn").length==0&&(f(!0),t(),window.popupCancelCallback&&(window.popupCancelCallback(),window.popupCancelCallback=null))}),e(".close,.pop_close").on("click",function(){return t(),!1})},u.activityDroplist=function(){function n(t,n){var r=e(n).parents(".main_item").data("identifier"),i=window.itemData[r],s="0";e(n).data("promotionId")!=null&&(s=e(n).data("promotionId"));var u="/cart/opt/changePromotion.do?skuId="+i.sku.id+"&itemType="+i.itemType+"&num="+i.num+"&promotionId="+s+"&targetId="+i.promotionId;t!=""&&(u=u+"&productPromotionId="+t);var a=o("common"),f={type:"num",url:u,showMsg:!1,time:80};a.ajax(f)}var t=e(".actvi_droplist");t.hover(function(){e(this).addClass("actvi_droplist_show")},function(){e(this).removeClass("actvi_droplist_show")}),t.find("li").on("click",function(){n("",this),e(this).addClass("v_choose").siblings("li").removeClass("v_choose");var t=e(this).parents("li").attr("id");t&&window.sessionStorage.setItem("cart_anchor",t)}),e(".ip_join").on("click",function(){var t="-1";e(this).hasClass("cancel")||(t=e(this).data("productPromotionId")),n(t,this)})},u.tipDialog=function(){function t(e,t,n){n?n:n=e,t.hasClass("slideUp")?(t.removeClass("slideUp"),n.removeClass("down")):(u.initDialog(),t.addClass("slideUp"),n.addClass("down"))}u.tipShow=t,e(".coupon").off().on("mouseover",function(){if(e(".popup_dialog").is(":visible"))return!1;e(this).children(".tag").addClass("down"),e(this).find(".tip_dialog").addClass("slideUp")}).on("mouseout",function(){e(this).children(".tag").removeClass("down"),e(this).find(".tip_dialog").removeClass("slideUp")}),e(".coupon").on("click",".rule_desc_zy",function(){if(e(this).hasClass("show_desc"))e(this).removeClass("show_desc"),e(this).siblings(".rule_list_con").css("height",0);else{e(this).addClass("show_desc");var t=e(this).siblings(".rule_list_con");t.css("height",t.find(".rule_list").height()+10)}}),e(".quick_makeup_btn").off().on("click",function(t){t.stopPropagation();var n=this,r=window.quickMakeup[e(n).data("promotionId")];e.ajax({url:"//pms.yhd.com/pms/getFullCutAddOnItems.do?callback=?",data:r.pmsdata,dataType:"jsonp",success:function(t){t&&t.value&&t.value.result.length?(t.value.displayName=r.displayName,e(".quick_makeup_dialog").html(s.template(e("#quick_makeup_dot").html())(t.value)),e(".quick_makeup_dialog .add_cart").off().on("click",function(){var t=e(this).data("pmId"),n=e(this).data("shoppingCount");o("cart_main_body").ajaxAddProductToCart(t,n)}),u.makeupScroll(".makeup_list"),u.initDialog(),e(this).PopupDialog({popupClass:".quick_makeup_dialog",maskLayer:!1,callback:function(){e(".coupon").hover(function(){return!1})}})):u.alert("暂无推荐商品",2)}})})},u.alert=function(e,t){u.dialog({tit:"disabled",txt:e,cancel:"disabled",delayClose:t,maskLayer:!1})},u.prodHover=function(){e(".sale_item").unbind("mouseenter mouseleave").each(function(){var t=e(this),n=t.find(".add_shopcart");t.hover(function(){n.addClass("add_shopcart_show").hover(function(){n.removeClass("as_icon_show").addClass("as_txt_show")},function(){n.removeClass("as_txt_show").addClass("as_icon_show")})},function(){n.removeClass("add_shopcart_show")})}),e(".cart_item .item").unbind("mouseenter mouseleave").hover(function(){e(this).parents("ul").hasClass("unable")||e(this).toggleClass("cur")}),e(".makeup_prod .tab").find("li").on("click",function(){e(this).addClass("cur").siblings("li").removeClass("cur")})},u.columnBar=function(){function d(e,n,i){if(i.hasClass(e)){n.show();var u=n.outerHeight(!0)-10;t.hasClass("tools_bar_top")?p.down(n):t.hasClass("tools_bar_bottom")?p.up(n,u):r-o>s/2?p.up(n,u):p.down(n)}}function v(i){var u=r+n-s,f=e(".rpt_detail"),l=/msie\s+[5-6]\./i.test(window.navigator.userAgent),c=e(".popup_dialog"),h=e(".tip_dialog"),p=e(".dialog");if(i<=a&&u>0){c.removeClass("pop_zIndexMore"),h.removeClass("pop_zIndexMore"),p.removeClass("pop_zIndexMore"),t.addClass("tools_bar_bottom").removeClass("tools_bar_top"),f.addClass("arrow_turn").removeClass("arrow_restore");var d=o+s-n;l&&e(".tools_bar_bottom").css({top:d})}else i>=r?(c.removeClass("pop_zIndexMore"),h.removeClass("pop_zIndexMore"),p.removeClass("pop_zIndexMore"),t.addClass("tools_bar_top").removeClass("tools_bar_bottom"),f.addClass("arrow_restore").removeClass("arrow_turn"),l&&e(".tools_bar_top").css({top:o})):(c.addClass("pop_zIndexMore"),h.addClass("pop_zIndexMore"),p.addClass("pop_zIndexMore"),t.removeClass("tools_bar_top tools_bar_bottom"),r-o>s/2?f.addClass("arrow_turn").removeClass("arrow_restore"):f.addClass("arrow_restore").removeClass("arrow_turn"),l&&t.css({top:0}))}function w(t,n){var r=Math.ceil(n.innerWidth()),i=t.width(),s=t.offset().left,o=e("body").width(),u=t.parents(".pay_tools_inner").width()-2,a=n.find(".t_arrow");if(r==u){var f=s-o/2+i/2;a.css("marginLeft",f)}else{var l=o/2-s+(r-i)/2+4;n.css("marginLeft",-l)}}if(!e(".pay_tools_bar").length)return;var t=e(".pay_tools_bar"),n=t.outerHeight(!0),r=t.offset().top,i=e(window),s=i.outerHeight(!0),o=i.scrollTop(),a=Math.abs(r-s)+n,l=e(".pay_tips"),c=e(".r_price_total"),h=e(".r_prod_view"),p;p={up:function(e,t){var n=t+8;e.css({top:-t}).find(".t_arrow").removeClass("t_arrow_top").addClass("t_arrow_bot").css({top:n})},down:function(e){var t="50px",n="-8px";e.css({top:t}).find(".t_arrow").removeClass("t_arrow_bot").addClass("t_arrow_top").css({top:n})}},v(o),i.on("scroll",function(){s=i.outerHeight(!0),o=i.scrollTop(),v(o),g.is(":visible")?(y.hide(),d("r_price_total",g,c)):y.is(":visible")&&(g.hide(),d("r_prod_view",y,h))});var m=e(".r_control_tip"),g=e(".pay_total_tips"),y=e(".pay_allprod_tips"),b=e(".pay_free_tips");e(".lt_free").off().on("click",function(t){t.stopPropagation();var n=e(this);o=i.scrollTop();var r=b.is(":visible");r?b.hide():(u.initDialog(),d("lt_free",b,n),w(n,b))}),e(".r_price_total").on("mouseenter",function(t){t.stopPropagation();var n=e(this),r=e(".pay_tips").is(":visible");if(r)return!1;o=i.scrollTop(),l.hide(),d("r_price_total",g,n),g.on("mouseover",function(){e(this).show()}).on("mouseout",function(){e(this).hide()})}).on("mouseleave",function(e){g.hide()}),e(".r_prod_view").off().on("click",function(t){if(!e(".pvw").is(":visible"))return;t.stopPropagation();if(e("#isMedicine").val()=="1")return;var n=e(this);e("#checkoutGroups").val()>1&&f(!1),d("r_prod_view",y,n),w(n,y),e(".pvw_sale_list").find(".sale_item").unbind("mouseenter mouseleave"),e(".pvw_sale_list").find(".sale_item").hover(function(){e(this).toggleClass("cur")}),u.columbBarScroll()})},u.initPopChat=function(){function n(){return yhdPublicLogin.getCookie("pin")?!0:!1}var t=e(".cart_tit.clearfix").map(function(t){if(e(this).data("merchantId")!="8888")return e(this).data("merchantId")}).get().join(",");e.ajax({url:"//chat1.jd.com/api/checkChat",data:{venderList:t,random:Math.random()},jsonpCallback:"jQuery"+e.now(),type:"get",dataType:"jsonp",error:function(){},success:function(t){for(var n=0;n<t.length;n++)t[n].code!="1"&&e("#"+t[n].venderId).addClass("unable")}}),e(".btn-im").on("click",function(e){n()||(e.preventDefault(),yhdPublicLogin.showLoginDiv("",!1,"2"))})},u.queryUserGoldNum=function(){e.ajax({url:"/cart/opt/queryUserGoldNum.do",data:{},jsonpCallback:"jQuery"+e.now(),type:"get",dataType:"jsonp",error:function(){window.userGoldNum="0"},success:function(e){window.userGoldNum=e.data.data}})},u.queryLandingDeliveryInfo=function(){var t=e(".landing_delivery").map(function(){return"{skuId:"+e(this).data("skuId")+",serviceItemId:"+e(this).data("landingDeliveryId")+",venderId:"+e(this).parents(".cart_list").find(".cart_tit.clearfix").data("merchantId")+",templateId:0}"}).get().join(",");e.ajax({url:"/cart/opt/getPopDeliveryName.do",data:{deliveryItemsStr:"["+t+"]"},jsonpCallback:"jQuery"+e.now(),type:"get",dataType:"jsonp",error:function(){window.userGoldNum="0"},success:function(e){window.landingDeliveryInfo=e.data.data}})},u.check=function(){function t(e){var t=o("common"),n={url:e,showMsg:!1,time:200};t.ajax(n)}e(".check,.checkbox").off().on("click",function(n){n.stopPropagation(),u.initDialog();var r;e(this).hasClass("checkbox")?r=e(this).find(".check"):r=e(this);var i=r.data("checkType"),s=i==1,o=r.hasClass("check_all"),a=r.hasClass("check_list"),f=r.hasClass("check_activity"),l=r.hasClass("check_item"),c;if(i==2)return;if(l){var h=e(this).parents(".main_item").data("identifier"),p=window.itemData[h],d=p.itemType==4?p.promotionId:p.sku.id,v=p.itemType,m=p.promotionId?p.promotionId:0;if(s){var g="/cart/opt/uncheckItem.do?skuId="+d+"&ptype="+v+"&targetId="+m+"&callback=?";t(g),r.removeClass("checked")}else{var g="/cart/opt/checkItem.do?skuId="+d+"&ptype="+v+"&targetId="+m+"&callback=?";t(g),r.addClass("checked")}}else if(o)if(s){var g="/cart/opt/uncheckAllItems.do?&callback=?";t(g),r.removeClass("checked")}else{var g="/cart/opt/checkAllItems.do?&callback=?";t(g),r.addClass("checked")}else if(a||f){c=a?e(this).parents(".cart_list").find(".check_item"):e(this).parents(".activity").find(".check_item");var y=0,b=e(c).map(function(){var t=e(this).parents(".main_item").data("identifier");p=window.itemData[t];var n=p.itemType==4?p.promotionId:p.sku.id,r=p.itemType,i=p.promotionId?p.promotionId:0,s="skuItems["+y++ +"]";return s+".itemId="+n+"&"+s+".itemType="+r+"&"+s+".targetId="+i}).get().join("&");if(s){var g="/cart/opt/uncheckItems.do?"+b+"&callback=?";t(g),c.removeClass("checked")}else{var g="/cart/opt/checkItems.do?"+b+"&callback=?";t(g),c.addClass("checked")}}}),window.ajaxFun=t},u.toolbar=function(){function p(){e(window).scroll(function(){h=e(window).scrollTop(),n.css("top",h)})}var t=e("body"),n=e(".c_global_toolbar"),r=e(".t_warp_slide_tabs .t_control_btn",n),s=e(".t_panel_content",n),a=s.find(".delete_all"),f=n.find(".tbar_slide_close"),l,c="undefined"==typeof document.body.style.maxHeight,h;c?p():"",r.on("click",function(t){t.stopPropagation();var r=e(this),i=r.attr("data-value"),o=n.find(".t_panel_content[data-value="+i+"]");r.hasClass("t_btn_selected")?u.initDialog():(r.addClass("t_btn_selected").siblings().removeClass("t_btn_selected"),o.removeClass("toolbar-animate-out").addClass("t_panel_content_show  toolbar-animate-in").siblings().removeClass("toolbar-animate-in t_panel_content_show").addClass("toolbar-animate-out"),s.find(".t_panel_wrap").scrollTop(0),n.hasClass("c_toolbar_open")||n.addClass("c_toolbar_open"))}),f.on("click",function(e){e.stopPropagation(),u.initDialog()}),e(".check,.checkbox").on("click",function(e){e.stopPropagation(),u.initDialog()}),a.click(function(e){e.stopPropagation(),n.find(".tbar_mask_layout").show(),n.find(".del_list_dialog").show()}),e(".close_btn,.sure_btn",n).click(function(t){t.stopPropagation(),n.find(".tbar_mask_layout").hide(),n.find(".del_list_dialog").hide();if(e(this).hasClass("sure_btn")){var r="/cart/opt/clearRecycleBin.do?callback=?",s=this;e.getJSON(r,function(t){if(i.isReqSuccess(t)){var n=o("doT").template(e("#recycler_dot").html())({});e(".t_panel_cont_recycler").find(".t_panel_wrap").html(n),e(".t_warp_slide_tabs").find("#trash").find(".c_lit_tip").html(0),e(a).hide()}})}})},u.otherJs=function(){e.fn.extend({preventScroll:function(){e(this).each(function(){var e=this;navigator.userAgent.indexOf("Firefox")>=0?e.addEventListener("DOMMouseScroll",function(t){e.scrollTop+=t.detail>0?10:-10,t.preventDefault()},!1):e.onmousewheel=function(t){return t=t||window.event,e.scrollTop+=t.wheelDelta>0?-10:10,!1}})}}),e(".t_panel_wrap").preventScroll(),e(".coupon_dialog_wrap").preventScroll(),e(".pay_allprod_tips").preventScroll()},u.columnBarArrow=function(){var t=e(".r_prod_view"),n=e(".pay_allprod_tips");if(!t||!n||!t.offset())return;var r=n.find(".t_arrow"),i=t.width(),s=n.width(),o=t.offset().left,u=e("body").width(),a=o-u/2+i/2;r.css("marginLeft",a)},u.animateAdd=function(){e(".tp_add_cart").on("click",function(){var t=e(this),n=t.data("pmInfoId"),r=e("li[data-pmInfoId="+n+"]");e("html, body").animate({scrollTop:r.offset().top},300,function(){setTimeout(function(){r.find(".item").last().slideDown(300),u.initClass()},300)})})},u.setCheckOutButtonStatus=f,u.flyItem=document.getElementById("flyItem"),u.flagMoving=!1,u.animateParabola=function(t,n){function g(){var t=o.parents("ul").children("li.item").length==1;e(u.flyItem).fadeOut(300),o.slideUp(300),t&&!r&&o.parents("ul").slideUp(300),setTimeout(function(){t&&!r&&o.parents("ul").remove(),o.remove(),u.initClass()},300),e(n).find(".add_tip").fadeIn(300),e(n).parents(".t_control_btn").addClass("has_tip"),u.flagMoving=!1,setTimeout(function(){e(n).find(".add_tip").fadeOut(500),e(n).parents(".t_control_btn").removeClass("has_tip")},1e3)}if(u.flagMoving==1)return!1;u.flagMoving=!0;var r=e(t).parents(".cart_prod").hasClass("yanbao"),i=e(t).parents("ul").hasClass("unable"),s=parseInt(e(n).find("b").html()),o;r?o=e(t).parents(".cart_prod"):i?o=e(t).parents("ul"):o=e(t).parents("li");var a=o.width(),f=o.height(),l=o.offset().top+f/2-25,c=o.offset().left+a/2,h=50/o.outerWidth(!0),p=50/o.outerHeight(!0),d=o.find(".item_pic").first().children("img"),v=d.attr("src");o.css({transform:"scaleX("+h+") scaleY("+p+")",transition:"transform ease .5s"}),setTimeout(function(){o.css("opacity",0),e(u.flyItem).show().css({top:l,left:c}).find("img").attr("src",v),m.position().move()},500);var m=funParabola(u.flyItem,n,{speed:200,curvature:.0012,complete:function(){g()}})},u.dialog=function(t){u.initDialog();var n={tit:"确认",txt:"确认执行此操作吗?",cancel:"取消",confirm:"确定",maskLayer:!0,delayClose:null,callback:function(){}},t=e.extend(!0,n,t),r=e(".pop_dialog.common");t.tit==="disabled"?r.find(".tit").hide():r.find(".tit").show(),t.txt==="disabled"?r.find(".txt").hide():r.find(".txt").show(),t.cancel==="disabled"?r.find(".cancel").hide():r.find(".cancel").show(),t.confirm==="disabled"?r.find(".confirm").hide():r.find(".confirm").show(),r.find(".tit").html(t.tit),r.find(".txt").html(t.txt),r.find(".cancel").html(t.cancel),r.find(".config").html(t.confirm),t.maskLayer?r.removeClass("tip_dialog"):r.addClass("tip_dialog"),r.PopupDialog({popupClass:".pop_dialog.common",maskLayer:t.maskLayer,delayClose:t.delayClose,callback:t.callback})},u.warning=function(t){u.initDialog(),$dialog=e(".pop_dialog.warn_pop"),e(".pop_dialog.warn_pop").PopupDialog({popupClass:".pop_dialog.warn_pop",callback:t.callback,cancelCallback:t.cancelCallback})},u}),define("common",["jquery","newCart","utils"],function(e,t,n){function i(){var e=0;this.entry=[],this.put=function(t,n){this.containsKey(t)||e++,this.entry[t]=n},this.get=function(e){return this.containsKey(e)?this.entry[e]:null},this.remove=function(t){delete this.entry[t]&&e--},this.containsKey=function(e){return e in this.entry},this.containsValue=function(e){for(var t in this.entry)if(this.entry[t]==e)return!0;return!1},this.values=function(){var t=new Array(e);for(var n in this.entry)t.push(this.entry[n]);return t},this.keys=function(){var t=new Array(e);for(var n in this.entry)t.push(n);return t},this.size=function(){return e},this.clear=function(){this.entry=[],this.size=0}}var r={};r.reqSucceed=function(e,n){if(e&&e.code&&e.code.length>=8){if(e.code=="00000000"||e.code=="00000001")return!0;var r=e.code.substring(0,3),i=e.code.substring(e.code.length-5,e.code.length);return r=="300"&&i=="00001"?(o.confirmFlag?yhdPublicLogin.showLoginDivNone("",!1,"",o.confirm,2):yhdPublicLogin.showLoginDiv("",!1,"2"),!1):(t.dialog({tit:"温馨提示",txt:e.msg,cancel:"disabled",confirm:"确定",delayClose:null,callback:function(){var t=!1;e.code=="50000019"&&(t=!0),e.msg&&!e.msg.indexOf("系统繁忙")&&(t=!0),t&&require("cart_main_body").initMainBody()}}),!1)}return t.dialog({tit:"系统繁忙",txt:"disabled",cancel:"disabled",confirm:"确定",delayClose:null,callback:function(){require("cart_main_body").initMainBody()}}),!1};var s={};s.map=new i,s.mergeSelect=function(){var e=!0;for(var t in this.map.entry){var n=this.map.get(t);if(n!=null&&n.stage==1){n.clearTimeout(),n.setTimeout(),e=!1;break}}return e},s.mergeDelete=function(e,t,n){var r=!0;for(var i in this.map.entry){var o=this.map.get(i);o!=null&&o.stage==1&&(o.type=="select"&&(o.clearTimeout(),s.map.remove(i)),o.type=="delete"&&(o.addDeletePost(options),o.clearTimeout(),o.setTimeout(),r=!1))}return r},s.mergeNum=function(e){var t=!0;for(var n in this.map.entry){var r=this.map.get(n);r!=null&&r.stage==1&&(r.type=="view"&&(r.clearTimeout(),s.map.remove(n)),r.type=="num"&&r.productId==e.productId&&(r.url=e.url,r.clearTimeout(),r.setTimeout(),t=!1))}return t},s.mergeLandingNum=function(e){var t=!0;for(var n in this.map.entry){var r=this.map.get(n);r!=null&&r.stage==1&&(r.type=="view"&&(r.clearTimeout(),s.map.remove(n)),r.type=="landingNum"&&r.productId==e.productId&&r.merchantId==e.merchantId&&r.promotionId==e.promotionId&&(r.url=e.url,r.clearTimeout(),r.setTimeout(),t=!1))}return t},s.mergePointProdNum=function(e){var t=!0;for(var n in this.map.entry){var r=this.map.get(n);r!=null&&r.stage==1&&(r.type=="view"&&(r.clearTimeout(),s.map.remove(n)),r.type=="pointProdNum"&&r.productId==e.productId&&r.merchantId==e.merchantId&&(r.url=e.url,r.clearTimeout(),r.setTimeout(),t=!1))}return t},s.mergeGoldProdNum=function(e){var t=!0;for(var n in this.map.entry){var r=this.map.get(n);r!=null&&r.stage==1&&(r.type=="view"&&(r.clearTimeout(),s.map.remove(n)),r.type=="goldProdNum"&&r.productId==e.productId&&r.merchantId==e.merchantId&&(r.url=e.url,r.clearTimeout(),r.setTimeout(),t=!1))}return t},s.mergeCombineNum=function(e){var t=!0;for(var n in this.map.entry){var r=this.map.get(n);r!=null&&r.stage==1&&(r.type=="view"&&(r.clearTimeout(),s.map.remove(n)),r.type=="combineNum"&&r.cartItemVoId==e.cartItemVoId&&(r.url=e.url,r.clearTimeout(),r.setTimeout(),t=!1))}return t},s.mergeOther=function(){for(var e in this.map.entry){var t=this.map.get(e);t!=null&&t.stage==1&&t.type=="select"&&(t.clearTimeout(),s.map.remove(e))}return!0},s.mergeReq=function(e){e.type=e.type||"other";var t=e.type;if(o.confirmFlag&&t!="check")return;if(this.map.size<=0){this.buildReq(e);return}var n=!0;t=="select"&&(n=this.mergeSelect()),t=="delete"&&(n=this.mergeDelete(e)),t=="num"&&(n=this.mergeNum(e)),t=="landingNum"&&(n=this.mergeLandingNum(e)),t=="pointProdNum"&&(n=this.mergePointProdNum(e)),t=="goldProdNum"&&(n=this.mergeGoldProdNum(e)),t=="combineNum"&&(n=this.mergeCombineNum(e)),t=="other"&&(n=this.mergeOther()),n&&this.buildReq(e)},s.buildReq=function(t){var r={};r.success=t.success,r.type=t.type,r.url=t.url,r.showMsg=t.showMsg,r.stage=0,r.timer=null;var s=t.type;s=="num"?(r.productId=t.productId,r.merchantId=t.merchantId):s=="landingNum"?(r.productId=t.productId,r.merchantId=t.merchantId,r.promotionId=t.promotionId):s=="pointProdNum"?(r.productId=t.productId,r.merchantId=t.merchantId):s=="goldProdNum"?(r.productId=t.productId,r.merchantId=t.merchantId):s=="combineNum"&&(r.cartItemVoId=t.cartItemVoId),s=="delete"&&(r.deleteRecord=new i,t.deleteId&&r.deleteRecord.put(t.deleteId,1),r.deleteId=[],r.deletePromo=[],r.addDeletePost=function(e){switch(e.deleteType){case 0:this.deleteId.push(e.deleteId);break;case 1:this.deletePromo.push(e.deleteId)}return this.deleteRecord.put(e.deleteId,1),!0},r.addDeletePost(t)),r.getParam=function(){var t=e("#currentCheckoutType").val(),r=null;r=e(".check_item").map(function(){return e(this).data("check-str")+"="+(e(this).hasClass("checked")?"1":"0")}).get().join(",");if(this.type=="delete"){var i={deleteId:this.deleteId.join(","),deletePromo:this.deletePromo.join(","),logged:n.getUserLoggedInPage(),view:o.length<=0&&!o.confirmFlag?1:0,isMedicine:e("#isMedicine").val()};return i}return{logged:n.getUserLoggedInPage(),view:o.length<=0&&!o.confirmFlag?1:0,isMedicine:e("#isMedicine").val()}},r.getUrl=function(){return this.url},r.post=function(){o.add(this)},r.setTimeout=function(){this.timer=setTimeout(function(){r.post()},!t.time||t.time<0?0:t.time),this.stage=1},r.clearTimeout=function(){this.timer&&clearTimeout(this.timer),this.stage=0},r.type=="check"?o.add(r):r.setTimeout(),this.map.put(r.timer,r)},r.reloadDelete=function(){e(".del_btn").each(function(){for(var t in s.map.entry){var n=s.map.get(t);n!=null&&n.type=="delete"&&n.stage<3&&n.deleteRecord.containsKey(e(this).data("deleteId"))&&e(this).parents(".item_line").remove()}})},s.anyTimeout=function(){for(var e in this.map.entry){var t=this.map.get(e);if(t&&t.stage==1)return!0}return!1};var o=[];return o.workingFlag=!1,o.confirmFlag=!1,o.showBlockUI=!1,o.timeup=!1,o.go=function(){if(o.workingFlag)return;o.timeup=!1,o.workingFlag=!0;if(o.length<=0){o.workingFlag=!1,o.confirmFlag&&!s.anyTimeout()&&(o.confirmFlag=!1,r.unblockUI(!1),e(".check_item.checked").length&&require("checkOut").goCheckout());return}var t=o.shift();if(t.type==null||t.type==""){t.stage=3,s.map.remove(t.timer),o.workingFlag=!1,o.go();return}!o.confirmFlag&&t.type=="other"&&r.blockUI(),e.getJSON(t.getUrl(),t.getParam(),function(e){if(o.timeup)return!1;t.stage=3,s.map.remove(t.timer),o.workingFlag=!1,r.reqSucceed(e)?(t.success&&t.success(e),o.showBlockUI=o.showBlockUI||t.showMsg,!o.confirmFlag&&o.length<=0?(r.unblockUI(o.showBlockUI),require("cart_main_body").refreshMainBody(e)):o.go()):(r.unblockUI(!1),o.confirmFlag&&(o.confirmFlag=!1),o.length=0)})},o.add=function(e){if(!o.confirmFlag||e.type=="check")e.stage=2,o.push(e),o.go()},o.confirm=function(){r.blockUI(),o.confirmFlag=!0;var e="/cart/mod/checkBC.do?callback=?";s.mergeReq({type:"check",url:e,showMsg:!1})},r.go2CheckOut=o.confirm,r=e.extend(r,{isBlocked:!1,ajax:function(e){s.mergeReq(e)},blockUI:function(){if(r.isBlocked)return;r.isBlocked=!0,e(this).PopupDialog({popupClass:".loading_pop",maskLayer:!1})},unblockUI:function(){r.isBlocked=!1,e(".pop_dialog.loading_pop").hide()}}),r}),function(){function e(e){function a(i,a){var l,h,m=i==window,g=a&&a.message!==undefined?a.message:undefined;a=e.extend({},e.blockUI.defaults,a||{});if(a.ignoreIfBlocked&&e(i).data("blockUI.isBlocked"))return;a.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,a.overlayCSS||{}),l=e.extend({},e.blockUI.defaults.css,a.css||{}),a.onOverlayClick&&(a.overlayCSS.cursor="pointer"),h=e.extend({},e.blockUI.defaults.themedCSS,a.themedCSS||{}),g=g===undefined?a.message:g,m&&o&&f(window,{fadeOut:0});if(g&&typeof g!="string"&&(g.parentNode||g.jquery)){var y=g.jquery?g[0]:g,b={};e(i).data("blockUI.history",b),b.el=y,b.parent=y.parentNode,b.display=y.style.display,b.position=y.style.position,b.parent&&b.parent.removeChild(y)}e(i).data("blockUI.onUnblock",a.onUnblock);var w=a.baseZ,E,S,x,T;n||a.forceIframe?E=e('<iframe class="blockUI" style="z-index:'+w++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+a.iframeSrc+'"></iframe>'):E=e('<div class="blockUI" style="display:none"></div>'),a.theme?S=e('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+w++ +';display:none"></div>'):S=e('<div class="blockUI blockOverlay" style="z-index:'+w++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),a.theme&&m?(T='<div class="blockUI '+a.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(w+10)+';display:none;position:fixed">',a.title&&(T+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(a.title||"&nbsp;")+"</div>"),T+='<div class="ui-widget-content ui-dialog-content"></div>',T+="</div>"):a.theme?(T='<div class="blockUI '+a.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(w+10)+';display:none;position:absolute">',a.title&&(T+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(a.title||"&nbsp;")+"</div>"),T+='<div class="ui-widget-content ui-dialog-content"></div>',T+="</div>"):m?T='<div class="blockUI '+a.blockMsgClass+' blockPage" style="z-index:'+(w+10)+';display:none;position:fixed"></div>':T='<div class="blockUI '+a.blockMsgClass+' blockElement" style="z-index:'+(w+10)+';display:none;position:absolute"></div>',x=e(T),g&&(a.theme?(x.css(h),x.addClass("ui-widget-content")):x.css(l)),a.theme||S.css(a.overlayCSS),S.css("position",m?"fixed":"absolute"),(n||a.forceIframe)&&E.css("opacity",0);var N=[E,S,x],C=m?e("body"):e(i);e.each(N,function(){this.appendTo(C)}),a.theme&&a.draggable&&e.fn.draggable&&x.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var k=s&&(!e.support.boxModel||e("object,embed",m?null:i).length>0);if(r||k){m&&a.allowBodyStretch&&e.support.boxModel&&e("html,body").css("height","100%");if((r||!e.support.boxModel)&&!m)var L=v(i,"borderTopWidth"),A=v(i,"borderLeftWidth"),O=L?"(0 - "+L+")":0,M=A?"(0 - "+A+")":0;e.each(N,function(e,t){var n=t[0].style;n.position="absolute";if(e<2)m?n.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+a.quirksmodeOffsetHack+') + "px"'):n.setExpression("height",'this.parentNode.offsetHeight + "px"'),m?n.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):n.setExpression("width",'this.parentNode.offsetWidth + "px"'),M&&n.setExpression("left",M),O&&n.setExpression("top",O);else if(a.centerY)m&&n.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),n.marginTop=0;else if(!a.centerY&&m){var r=a.css&&a.css.top?parseInt(a.css.top,10):0,i="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+r+') + "px"';n.setExpression("top",i)}})}g&&(a.theme?x.find(".ui-widget-content").append(g):x.append(g),(g.jquery||g.nodeType)&&e(g).show()),(n||a.forceIframe)&&a.showOverlay&&E.show();if(a.fadeIn){var _=a.onBlock?a.onBlock:t,D=a.showOverlay&&!g?_:t,P=g?_:t;a.showOverlay&&S._fadeIn(a.fadeIn,D),g&&x._fadeIn(a.fadeIn,P)}else a.showOverlay&&S.show(),g&&x.show(),a.onBlock&&a.onBlock.bind(x)();c(1,i,a),m?(o=x[0],u=e(a.focusableElements,o),a.focusInput&&setTimeout(p,20)):d(x[0],a.centerX,a.centerY);if(a.timeout){var H=setTimeout(function(){m?e.unblockUI(a):e(i).unblock(a)},a.timeout);e(i).data("blockUI.timeout",H)}}function f(t,n){var r,i=t==window,s=e(t),a=s.data("blockUI.history"),f=s.data("blockUI.timeout");f&&(clearTimeout(f),s.removeData("blockUI.timeout")),n=e.extend({},e.blockUI.defaults,n||{}),c(0,t,n),n.onUnblock===null&&(n.onUnblock=s.data("blockUI.onUnblock"),s.removeData("blockUI.onUnblock"));var h;i?h=e("body").children().filter(".blockUI").add("body > .blockUI"):h=s.find(">.blockUI"),n.cursorReset&&(h.length>1&&(h[1].style.cursor=n.cursorReset),h.length>2&&(h[2].style.cursor=n.cursorReset)),i&&(o=u=null),n.fadeOut?(r=h.length,h.stop().fadeOut(n.fadeOut,function(){--r===0&&l(h,a,n,t)})):l(h,a,n,t)}function l(t,n,r,i){var s=e(i);if(s.data("blockUI.isBlocked"))return;t.each(function(e,t){this.parentNode&&this.parentNode.removeChild(this)}),n&&n.el&&(n.el.style.display=n.display,n.el.style.position=n.position,n.el.style.cursor="default",n.parent&&n.parent.appendChild(n.el),s.removeData("blockUI.history")),s.data("blockUI.static")&&s.css("position","static"),typeof r.onUnblock=="function"&&r.onUnblock(i,r);var o=e(document.body),u=o.width(),a=o[0].style.width;o.width(u-1).width(u),o[0].style.width=a}function c(t,n,r){var i=n==window,s=e(n);if(!t&&(i&&!o||!i&&!s.data("blockUI.isBlocked")))return;s.data("blockUI.isBlocked",t);if(!i||!r.bindEvents||t&&!r.showOverlay)return;var u="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";t?e(document).bind(u,r,h):e(document).unbind(u,h)}function h(t){if(t.type==="keydown"&&t.keyCode&&t.keyCode==9&&o&&t.data.constrainTabKey){var n=u,r=!t.shiftKey&&t.target===n[n.length-1],i=t.shiftKey&&t.target===n[0];if(r||i)return setTimeout(function(){p(i)},10),!1}var s=t.data,a=e(t.target);return a.hasClass("blockOverlay")&&s.onOverlayClick&&s.onOverlayClick(t),a.parents("div."+s.blockMsgClass).length>0?!0:a.parents().children().filter("div.blockUI").length===0}function p(e){if(!u)return;var t=u[e===!0?u.length-1:0];t&&t.focus()}function d(e,t,n){var r=e.parentNode,i=e.style,s=(r.offsetWidth-e.offsetWidth)/2-v(r,"borderLeftWidth"),o=(r.offsetHeight-e.offsetHeight)/2-v(r,"borderTopWidth");t&&(i.left=s>0?s+"px":"0"),n&&(i.top=o>0?o+"px":"0")}function v(t,n){return parseInt(e.css(t,n),10)||0}e.fn._fadeIn=e.fn.fadeIn;var t=e.noop||function(){},n=/MSIE/.test(navigator.userAgent),r=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),i=document.documentMode||0,s=e.isFunction(document.createElement("div").style.setExpression);e.blockUI=function(e){a(window,e)},e.unblockUI=function(e){f(window,e)},e.growlUI=function(t,n,r,i){var s=e('<div class="growlUI"></div>');t&&s.append("<h1>"+t+"</h1>"),n&&s.append("<h2>"+n+"</h2>"),r===undefined&&(r=3e3);var o=function(t){t=t||{},e.blockUI({message:s,fadeIn:typeof t.fadeIn!="undefined"?t.fadeIn:700,fadeOut:typeof t.fadeOut!="undefined"?t.fadeOut:1e3,timeout:typeof t.timeout!="undefined"?t.timeout:r,centerY:!1,showOverlay:!1,onUnblock:i,css:e.blockUI.defaults.growlCSS})};o();var u=s.css("opacity");s.mouseover(function(){o({fadeIn:0,timeout:3e4});var t=e(".blockMsg");t.stop(),t.fadeTo(300,1)}).mouseout(function(){e(".blockMsg").fadeOut(1e3)})},e.fn.block=function(t){if(this[0]===window)return e.blockUI(t),this;var n=e.extend({},e.blockUI.defaults,t||{});return this.each(function(){var t=e(this);if(n.ignoreIfBlocked&&t.data("blockUI.isBlocked"))return;t.unblock({fadeOut:0})}),this.each(function(){e.css(this,"position")=="static"&&(this.style.position="relative",e(this).data("blockUI.static",!0)),this.style.zoom=1,a(this,t)})},e.fn.unblock=function(t){return this[0]===window?(e.unblockUI(t),this):this.each(function(){f(this,t)})},e.blockUI.version=2.7,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var o=null,u=[]}typeof define=="function"&&define.amd&&define.amd.jQuery?define("blockUI",["jquery"],e):e(jQuery)}();var webIM={_positionId:5,_mcsite:3,_domain:"//webim.yhd.com",show1mallIM:function(){var e=0;jQuery("[class=show1mallIM][setted=false]").each(function(t){var n=$(this),r=n.attr("value"),i="/interface/show_qq_info_lite.action?r="+Math.random()+"&merchantId="+r+"&position=0&limPage=1&limType=small&type=html&jsonpCallback=?";jQuery.getJSON(i,function(t){if(t.code==0){n.html(t.msg);if(e==0){e=1;var r=$("<link/>");$(r).attr("type","text/css"),$(r).attr("rel","stylesheet"),r.attr("href",t.cssFile),$("head").append(r);var i=document.createElement("script");i.type="text/javascript",i.src=t.jsFile,document.getElementsByTagName("head")[0].appendChild(i)}}})})},requestNewWebIM:function(){var e=this,t=0;$(".show1mallIM").each(function(n){var r=$(this),i=r.data("merchantId"),s=e._domain+"/checkPoint/showPoint/"+i+"/"+e._positionId+"/0/0/"+e._mcsite+".action",o="?iconType=small&jsonpCallback=?";jQuery.getJSON(s+o,function(n){if(n&&isNaN(n)){var i="";if(t==0)t=1,i=n;else{var s=jQuery(n).find("#onlineChatSpan");s.length>0?i=s:i=n}r.html(i)}else r.attr("setted",!1),e.show1mallIM()})})}};typeof define=="function"&&define.amd&&define("WebIM",[],function(){return webIM}),function(e){e.fn.countdown=function(t){function n(e,t){this.element=e,this.init()}return n.prototype={init:function(){this.options=e.extend({},t||{}),this.time=null,this.options.endTime?this.endTime=new Date(this.options.endTime):this.endTime=new Date((new Date).getTime()+(this.options.time||0)),this.updateTime(this)},getTimes:function(e,t,n){var r=new Date,i=e.endTime;e.t=i-r,e.h=Math.floor(e.t/1e3/60/60%24),e.m=Math.floor(e.t/1e3/60%60),e.s=Math.floor(e.t/1e3%60),r<i?typeof t=="function"&&t(e.element,e.h>9?e.h:"0"+e.h,e.m>9?e.m:"0"+e.m,e.s>9?e.s:"0"+e.s):(clearInterval(e.time),typeof n=="function"&&n())},updateTime:function(e){e.time=setInterval(function(){e.getTimes(e,e.options.onTick,e.options.onExpiry)},1e3)}},this.each(function(){new n(e(this),t)})}}(jQuery),define("countdown",function(){}),define("cart_main_body",["jquery","dotdotdot","common","doT","blockUI","newCart","utils","WebIM","countdown"],function($,dotdotdot,common,doT,blockUI,newCart,utils,webIM,countdown){function calSubTotal(e){var t=e.sku.id;e.itemType==4&&(t=e.promotionId);var n=e.itemType,r=e.promotionId?e.promotionId:0,i=calItemNum(e);i=i>200?200:i,i=i<1?1:i;var s={type:"num",url:"/cart/opt/editNum.do?pid="+t+"&ptype="+n+"&targetId="+r+"&pcount="+i+"&callback=?",showMsg:!1,time:200,productId:t};return common.ajax(s),!0}function calItemNum(e){var t=e.amount,n=$("input[type='hidden'][name='num_"+e.productId+"_"+e.merchantId+"_"+(e.simpleItemType==0?1:0)+"']");return n.size()>0&&e.bindingFlag!=1&&(t+=parseInt(n.val())),t}function chooseSerialGift(e){var t=$(e).data("productId"),n=$(e).data("merchantId"),r=$(e).data("promotionId"),i=$(e).data("promotionLevelId"),s=$(e).data("num"),o=$(e).data("pmInfoId"),u="/cart/newCart/opt/getMainProductSerialAttr.do?callback=?",a={originalProductId:t,merchantId:n,promotionId:r,promotionLevelId:i,num:s,serialProductId:t};$.getJSON(u,a,function(t){if(utils.isReqSuccess(t)){var u="",a=$(e).data("productId"),f=t.data.serialAttrMap;for(var l in f)if(t.data.serialAttrMap[l]==a){u=l;break}var c=!0,h=refreshSerialAttrStatusForModify(t,c,u,e,0),p=doT.template($("#sub_product_serial_dot").html())($.extend(t.data,{curAttr:u,availAttributes:h,serialGift:"1"}));$(".pop_serial_gift").html(p),$(".error_tip").css("display","none"),$(e).PopupDialog({popupClass:".free_proedit_pop",maskLayer:!0}),d();function d(){var t=$(".free_proedit_pop"),n=$(".free_proedit_pop").find(".error_tip"),r=t.find(".confirm"),i=t.find(".prop_list");r.on("click",function(){if(t.find(".cur").length!=i.length)return n.show(),!1;$(e).addClass("checked"),$("#batchChooseGift").removeClass("unable"),t.find(".pop_close").trigger("click")})}$(".prop_list").children("li").on("click",function(){$(this).hasClass("unable")||$(this).addClass("cur").siblings("li").removeClass("cur"),u=$(".free_proedit_pop").find(".prop_item").map(function(e,t){return $(t).data("attributeId")+"-"+$(t).find("li.cur").data("attributeValueId")}).get().join("_"),h=refreshSerialAttrStatusForModify(t,c,u,this,0)}),$(".free_proedit_pop").find(".confirm").on("click",function(){var t=!1;$(".prop_list").each(function(){if(!$(this).children("li").hasClass("cur"))return t=!0,!1});if(t)return $(".error_tip").find("span").text("请选择商品的属性"),$(".error_tip").css("display","block"),!1;var a=f[u];$(e).data("promotionId",r),$(e).data("promotionLevelId",i),$(e).data("merchantId",n),$(e).data("productId",a),$(e).data("num",s),$(e).data("pmInfoId",o),$(e).parent().hasClass("free_list_item")||(require("cart_main_body").ajaxChooseGift(e),newCart.initDialog()),$(".pop_dialog:visible").find(".pop_close").trigger("click")})}})}function calcUnavailableCoordinate(e,t,n,r,i,s,o){var u=new Array;for(var a=0;a<e.length;a++){var f="";for(var l=1;l<5;l++)if(e[a][l]!=null&&e[a][l]!=""){var c=t[l-1].attributeValueList;for(var h=0;h<c.length;h++)e[a][l]==c[h].attributeValueAlias&&(f=f+c[h].attributeValueId+"_")}u[a]=f,o[f]=e[a].skuId}n=n.split("_");var p=new Array,d=new Array;for(var a=0;a<n.length;a++)if(n[a]!="")for(var l=0;l<r[a].length;l++){p=n.slice(0),p[a]=r[a][l]+"";var v="";for(var h=0;h<p.length;h++)p[h]!=""?v=v+p[h]+"_":v=v+a+"";d.push(v)}var m=new Array;for(var a=0;a<d.length;a++){var g=d[a].substr(0,d[a].length-1);if($.inArray(g,u)<0){var y=new Array;y=d[a].split("_"),m.push(y[y.length-1]+"-"+(parseInt(y[y[y.length-1]])-1))}}return i||$(s).parents(".prop_dialog_wrap").find("li.seri_attr_value").each(function(){curAttrValueId=$(this).data("attributeValueId")-1,n=$(this).data("attributeId")-1;var e=!1;$.inArray(n+"-"+curAttrValueId,m)<0&&(e=!0),e?$(this).removeClass("unable"):$(this).addClass("unable")}),m}function refreshSerialAttrStatusForModify(e,t,n,r,i){var s=[],o=e.data.avaliableSubProducts;if(!o)return;o=o.split(";");if(!o)return;var u=e.data.allSerialAttributes;for(var a=0;a<u.length;a++){var f=u[a].attributeId,l=o.slice(0);for(var c=0;c<u.length;c++){var h=u[c].attributeId;if(h==f)continue;var p="";if(t){var d=n.split("_");for(var v=0;v<d.length;v++)if(h==d[v].split("-")[0]&&d[v].split("-")[1]!="undefined"){p=d[v].split("-")[1];break}}else{var m=$(r).parents(".prop_dialog_wrap");m.find(".prop_color_list").each(function(){var e=$(this).attr("data-attribute-id");h==e&&$(this).find(".seri_attr_value").each(function(){$(this).hasClass("cur")&&(p=$(this).attr("data-attribute-value-id"))})})}for(var g=0;g<l.length;g++){if(l[g]==null)continue;var y=l[g].split(",");for(var b=0;b<y.length;b++){var w=y[b].split("_");if(w[0]==h){p!=""&&w[1]!=p&&(l[g]=null);break}}}}for(var g=0;g<l.length;g++)if(null!=l[g]){var y=l[g].split(",");for(var b=0;b<y.length;b++){var w=y[b].split("_");if(w[0]==f){s.push(w[1]);break}}}var m;i=="0"?m=$(r).parents(".free_proedit_pop"):m=$(r).parents(".prop_dialog_wrap"),m.find("li.seri_attr_value").each(function(){curAttrValueId=jQuery(this).attr("data-attribute-value-id");var e=!1;for(var t=0;t<s.length;t++)if(s[t]==curAttrValueId){e=!0;break}e?jQuery(this).removeClass("unable"):jQuery(this).addClass("unable")})}var E="";for(var S=0;S<s.length;S++)E+=s[S]+"-";return E}function couponPageClickKeyLog(e,t){try{log("CouponYhd","PickCouponYhd",2,e,t)}catch(n){}}function getRecycleItemInfo(e){var t=$(e);if(t.data("bind"))return;var n=t.parents(".main_item").data("identifier"),r=window.itemData[n];return{itemInfo:r,identifier:n,isSuit:r.itemType==4}}var exports={};return exports.makeUpItem=function(){function e(e,n){t(n,function(){newCart.tipShow($(n),$(e))})}function t(e,n){var r=$(e).data("merchantId"),i=parseFloat($(e).data("marginamountPrice")||"0"),s=i<=15?1:15<i&&i<=30?2:30<i&&i<=45?3:45<i&&i<=60?4:5;if(n==undefined||n==null)s=$(e).data("difference");var o="#merchant_"+r+"_makeup",u=2,a=$(".cart_list_wrap.zy .check.check_item.checked.fresh").map(function(){return $(this).parents(".cart_prod").find(".item_a_money").text()}).get(),f=0;for(var l=0;l<a.length;l++)f+=parseFloat(a[l]);var c=$(".cart_list_wrap.zy .check.check_item.checked.nofresh").map(function(){return $(this).parents(".cart_prod").find(".item_a_money").text()}).get(),h=0;for(var p=0;p<c.length;p++)h+=parseFloat(c[p]);a.length==0&&c.length!=0?u=2:a.length!=0&&c.length==0?u=1:f>86?u=2:h>86?u=1:u=3;var d=$(".cart_list_wrap.zy .check_item").map(function(){if($(this).hasClass("checked"))return $(this).data("skuWeight")}).get().join();s==1?(max="15",min="0"):s==2?(max="30",min="15"):s==3?(max="45",min="30"):s==4?(max="60",min="45"):(s=5,max="86",min="60");var v=u==1?"1":"0";$(".cur.coudan_type").hasClass("isfresh_btn")&&(v="1");var m={max:max,min:min,area:$.cookie("yhd_location").replace(new RegExp("_","g"),","),wt:20-d,fr:v};common.blockUI();var g=$(".cart_list_wrap.zy .check_item").map(function(){if($(this).hasClass("checked"))if(v=="1"){if($(this).hasClass("fresh")){var e=$(this).data("skuId"),t=$(this).data("pkgSkusId");return t&&(e=t),e}}else if(!$(this).hasClass("fresh")){var e=$(this).data("skuId"),t=$(this).data("pkgSkusId");return t&&(e=t),e}}).get().join(","),y={p:"619064",skus:g,lim:24,deviceCode:$.cookie("cart_cookie_uuid"),hi:JSON.stringify(m)},b="/cart/opt/yhdDiviner.do";$.ajax({type:"GET",jsonpCallback:"jQuery"+$.now(),dataType:"jsonp",url:b,data:y,success:function(i){if(i.code=="00000000"&&i.data){i.hasFresh=u;var a=doT.template($("#makeUpItems").html())(i);$(o).html(a),$(o).find(".switchTab").unbind("click").bind("click",function(){t(this)}),$(".coudan_type").unbind("click").bind("click",function(){$(this).addClass("cur").siblings("a").removeClass("cur"),t(this)}),$(e).attr("class")=="switchTab"?newCart.makeupScroll("#merchant_"+$(e).data("merchantId")+"_makeup"):newCart.makeupScroll("#"+$(e).attr("id")+"_makeup"),$("#table_"+s).addClass("cur"),v=="1"?$(".isfresh_btn").addClass("cur").siblings("a").removeClass("cur"):$(".notfresh_btn").addClass("cur").siblings("a").removeClass("cur"),$(".makeup_prod .tab").find("li").on("click",function(){$(this).addClass("cur")});var f='.makeup_tip[data-merchant-id="'+r+'"]',l=null,c=$(f).find("a");l&&l.length&&($(f).html(""),$(c).appendTo($(f).append(l))),$(".similar_prod").find(".prod_item").hover(function(){$(this).addClass("cur")},function(){$(this).removeClass("cur")}),$(".makeup_prod .add_btn").on("click",function(){var e=$(this).data("pmId"),t=$(this).data("shoppingCount");exports.ajaxAddProductToCart(e,t)}),$(o).find("li").attr("merchantId",r).attr("difference",s),n&&n()}},complete:function(){common.unblockUI()}})}$(".cart_list").each(function(){$(this).find(".checked").length||$(this).find(".free_pos").remove()}),$(".order_makeup_btn").on("click",function(t){var n="#"+$(this).attr("id")+"_makeup";if(!$(n).hasClass("slideUp"))e(n,this);else{var r=$(this).data("merchantId"),i='.makeup_tip[data-merchant-id="'+r+'"]',s=$(i).find("a"),o=$("#hidden_delivery_fee_desc_"+r).val();o&&o.length&&($(i).html(""),$(s).appendTo($(i).append(o))),newCart.tipShow($(this),$(n))}})},exports.payBarBatchChooseGift=function(){function a(){$(".free_list_item").each(function(){$(this).find(".free_check").hasClass("checked")&&s++}),s==0?$("#batchChooseGift").addClass("unable"):$("#batchChooseGift").removeClass("unable")}var e=new Array,t=new Array,n=new Array,r=new Array,i=new Array,s=0,o="",u="";$(".free_check").on("click",function(e){e.stopPropagation();var t=$(this).data("isSeries");if($(this).hasClass("checked"))$(this).removeClass("checked"),t==1&&$(this).data("productId",$(this).data("mainProductId"));else{var n=$(this).data("selectType"),r=$(this).attr("name");n==2&&$('a[name="'+r+'"]').each(function(){$(this).removeClass("checked")}),t==1?chooseSerialGift(this):$(this).addClass("checked")}a()}),$("#batchChooseGift").on("click",function(a){a.stopPropagation();if($(this).hasClass("unable"))return;$(".free_list_item").each(function(){$(this).find(".free_check").hasClass("checked")&&(e[s]=$(this).find(".choose_gift").data("promotionId"),t[s]=$(this).find(".choose_gift").data("promotionLevelId"),n[s]=$(this).find(".choose_gift").data("productId"),r[s]=$(this).find(".choose_gift").data("merchantId"),i[s]=$(this).find(".choose_gift").data("num"),o+="&promotionIDs="+e[s]+"&promotionLevelIDs="+t[s]+"&promotionGiftIDs="+n[s]+"&promotionGiftMerchantIDs="+r[s]+"&promotionGiftNum="+i[s])}),o=o.substring(1,o.length),u="/cart/newCart/opt/addPromo.do?"+o+"&callback=?",newCart.initDialog(),common.ajax({url:u})})},exports.ajaxAddProductToCart=function(e,t,n){if(!e)return;var r="/cart/opt/add.do?pid="+e+"&pcount="+(t||1)+"&ptype="+(n||1)+"&callback=?";common.ajax({url:r})},exports.ajaxAddSimilarProductToCart=function(e,t,n){if(!e||!t)return;var r="/cart/newCart/opt/add.do?productId="+e+"&merchantId="+t+"&num="+(n||1)+"&callback=?";common.ajax({url:r})},exports.loadWarningMessage=function(){var e="/cart/mod/advertisementService.do",t=$.cookie("yhd_location"),n;t!=null&&(n=t.split("_")[0]);var r={mcSiteId:"1",code:"GWCPC_YMGG_MR_MR",provinceId:n,level:"4"};$.ajax({url:e,data:r,dataType:"json",success:function(e){if(!e.data||!e.data.sourceList||!e.data.sourceList[0]||!e.data.sourceList[0].name)$(".top_tip").hide();else{var t=doT.template($("#dot-messageWrap").html())(e.data.sourceList[0].name);$(".top_tip").show().children("p").html(t)}}})},exports.editNum=function(e){$div=$(e).parent();var t=$(e).parents(".main_item").data("identifier"),n=window.itemData[t];n.input=$div.find(".input"),n.amount=parseInt($div.find(".input").val()),calSubTotal(n)},exports.ajaxChooseGift=function(e,t){function i(){if(t.selectedGifts&&t.selectedGifts.length==n.length){for(var e=0;e<n.length;e++)if(n[e]!=t.selectedGifts[e].id)return!1;return!0}return!1}var n=[];e.find(".give_present_btn").each(function(e,t){$(t).hasClass("red")||n.push($(t).data("skuId"))});if(i())return;if(t.canSelectGiftNum&&n.length>t.canSelectGiftNum)return;if(n.length){var r="/cart/opt/addGiftsOfMZ.do?pids="+n.join(",")+"&promoId="+t.id+"&callback=?";common.ajax({url:r})}else common.ajax({url:"/cart/opt/removeGiftsOfMZ.do?promoId="+t.id+"&callback=?"})},exports.initCheckOutBar=function(e){if(e.cartVo&&e.cartVo.empty){$("#checkOutBar").html("").hide();return}var t=$("#dot-checkOutBar").html(),n=doT.template(t)(e);$("#checkOutBar").html(n).show();var r=doT.template($("#cartPreview").html())(e.checkOutPreviewVo);$(".pay_allprod_tips").html(r),$(".pvw_sale_title .close").on("click",function(){newCart.setCheckOutButtonStatus(!0),$(".pay_tips").hide()}),$(".settle_accounts_btn").on("click",function(){require("checkOut").singleCheckout(this)}),newCart.columnBarArrow(),newCart.columnBar(),newCart.setCheckOutButtonStatus(!0);var i=$(".cart_prod.clearfix.unable").map(function(){return $(this).find(".del_btn").data("deleteId")}).get().join(",");i==""&&$("#batchDelete").hide()},exports.loadRedemption=function(){var e=$(".check_item").map(function(){if($(this).hasClass("checked"))return $(this).data("check-str")+"=1"}).get().join(",");if(e==null||$.trim(e).length==0){$("#redemptions").empty();return}var t="/cart/newCart/mod/cart4Redeem.do?callback=?";$.ajax({type:"get",dataType:"json",url:t,success:function(e){if(!common.reqSucceed(e)||!e.data){$("#redemptions").empty();return}var t=doT.template($("#dot-redemptions").html())(e.data);$("#redemptions").html(t),$(".sale_item").each(function(){var e=$(this),t=e.find(".add_shopcart");e.hover(function(){t.addClass("add_shopcart_show").hover(function(){t.removeClass("as_icon_show").addClass("as_txt_show")},function(){t.removeClass("as_txt_show").addClass("as_icon_show")})},function(){t.removeClass("add_shopcart_show")})}),$(".redem.add_shopcart").on("click",function(){exports.ajaxChooseGift(this)}),newCart.changeBuyScroll()}})},gotrackerWithSpmData=function(e,t,n,r){var i=loli.spm.getData(r);i.positionTypeId="4"},exports.loadRecommendation=function(){var e="/cart/opt/yhdDiviner.do?callback=?";$.ajax({type:"get",dataType:"json",url:e,data:{p:"205000",lim:"40",deviceCode:$.cookie("cart_cookie_uuid")},success:function(e){if(e.code=="00000000"){var t=e.data;if(t){var n=$("#recommendation_dot").html(),r=doT.template(n);$("#recommendation").html(r(t)),newCart.guessLikeScroll(),newCart.prodHover(),$(".recom_add").on("click",function(){var e=$(this).data("pid"),t=$(this).data("shoppingCount"),n=1;exports.ajaxAddProductToCart(e,n,t)}),$(".guessULike.scrollLoading").scrollLoading()}else $("#recommendation").html("")}}})},exports.recommendGoods=function(){$(".similar_btn").click("click",function(e){if($(this).hasClass("notEmpty")||$(this).siblings(".similar_prod").hasClass("slideUp"))newCart.tipShow($(this),$(this).siblings(".similar_prod"),$(this).parent());else{$(this).removeClass("notEmpty");var t=$(this).data("skuId"),n=$(this).data("merchantId"),r=this,i="<p class='no_empty'><i></i>暂无推荐商品</p>";$.ajax({type:"GET",dataType:"jsonp",jsonpCallback:"jQuery"+$.now(),timeout:1e3,url:"/cart/opt/yhdDiviner.do",data:{p:"619028",sku:t,lim:"24",deviceCode:$.cookie("cart_cookie_uuid")},error:function(){$(r).siblings(".similar_prod").html(i)},success:function(e){var t=e.data;if(t&&t.length>0){var n=doT.template($("#similar_product_dot").html())(t);$(r).siblings(".similar_prod").html(n),$(r).addClass("notEmpty"),$(r).siblings(".similar_prod").find(".prod_item").hover(function(){$(this).addClass("cur")},function(){$(this).removeClass("cur")}),$(r).siblings(".similar_prod").find(".add_btn").on("click",function(){var e=$(this).data("pmId"),t=$(this).data("shoppingCount");exports.ajaxAddProductToCart(e,t)}),newCart.similarScroll(".similar_con_wrap")}else $(r).siblings(".similar_prod").html(i);newCart.tipShow($(r),$(r).siblings(".similar_prod"),$(r).parent())}})}})},exports.checkItemLimit=function(data){var specialOfferItemNum,specialOfferItem;data.mainItem?specialOfferItem=data.mainItem:specialOfferItem=data,specialOfferItem.promoteOverLimitDisplayTag&&(specialOfferItemNum=eval($('[data-tag="'+specialOfferItem.promoteOverLimitDisplayTag+'"]').map(function(){return $(this).siblings(".item_num").find(".input").val()}).get().join("+")));var check={aborted:!0},inputNum=data.inputNum,validateNum=data.inputNum;data.validateNum=data.inputNum,data.mainItem&&data.validateNum>data.mainItem.allNum&&(validateNum=data.mainItem.allNum,check.msg="搭售品数量不能超过主品数量");if(data.currentStockNum){var limitedStockMsg="";data.currentStockNum<200?(data.maxNum=data.currentStockNum,limitedStockMsg="库存有限，"):data.maxNum=200;if(data.maxNum<=0)return check.msg="该商品 已下架或无库存",check;!data.mainItem&&specialOfferItemNum&&specialOfferItemNum>data.maxNum?(validateNum=data.inputNum-(specialOfferItemNum-data.maxNum),check.msg="该商品"+limitedStockMsg+"您最多只能购买"+validateNum+"件"):data.maxNum<validateNum&&(check.msg="该商品"+limitedStockMsg+"您最多只能购买"+data.maxNum+"件",validateNum=data.maxNum)}if(data.mainItem)return check.msg||(check.aborted=!1),data.validateNum=validateNum,check;var shoppingCountNum=data.sku.shoppingCount,skuTensionNum=data.sku.skuTensionNum;data.simpleItemType=0;switch(data.simpleItemType){case 0:if(data.sensitive&&data.dailyPurchaseMaxCount){var buyMore=data.dailyPurchaseMaxCount-data.dailyCount;buyMore<validateNum&&(validateNum=buyMore,check.msg="该商品为特价限购商品，最多购买"+data.dailyPurchaseMaxCount+"件",data.dailyCount>0&&(check.msg+="，您已购买过"+data.dailyCount+"件，还能再购买"+buyMore+"件!"))}else if(data.perOrderQuota&&data.perOrderQuota<validateNum)validateNum=data.perOrderQuota,check.msg="该商品[每单限购"+data.perOrderQuota+"件]";else if(shoppingCountNum>1&&validateNum<shoppingCountNum)check.msg="该商品["+shoppingCountNum+"件起购]",validateNum=shoppingCountNum,check.checkPoint="起购";else if(skuTensionNum>=1&&parseInt(validateNum)>parseInt(skuTensionNum))check.msg="该商品[仅剩"+skuTensionNum+"件]",validateNum=skuTensionNum,check.checkPoint="库存紧张";else{var promoteType=data.promoteType;if(data.totalLimitNum>0&&data.totalLimitNum<validateNum)if(promoteType==2||promoteType==4)check.msg="该商品[每单限购"+data.totalLimitNum+"件],超过则以1号店价购买",check.aborted=!1;else if(promoteType==5||data.presell||promoteType==6)validateNum=data.totalLimitNum,check.msg="该商品[限购"+data.totalLimitNum+"件]";data.userLimitNum>0&&validateNum>data.userLimitNum&&(check.msg="该商品[每人限购"+data.userLimitNum+"件]",!data.presellcommon&&promoteType!=6&&promoteType!=3?(check.msg+=",超过则以1号店价购买",check.aborted=!1):validateNum=data.userLimitNum)}break;case 2:data.landingNumLimit&&validateNum>data.landingNumLimit?(check.msg="该商品为特价商品，您最多只能购买"+data.landingNumLimit+"件",validateNum=data.landingNumLimit):shoppingCountNum>1&&validateNum<shoppingCountNum&&(check.msg="该商品["+shoppingCountNum+"件起购]",validateNum=shoppingCountNum);break;case 3:data.userLimitNum>0&&validateNum>data.userLimitNum&&(validateNum=data.userLimitNum,check.msg="积分商品每单限购"+data.userLimitNum+"件")}return check.msg||(check.aborted=!1),data.validateNum=validateNum,check},exports.numAct=function(){function e(e){$div=$(e).parent();var t=$(e).parents(".main_item").data("identifier"),n=window.itemData[t];n.inputNum=$div.find(".input").val();var r=exports.checkItemLimit(n);if(r.aborted){var i='<div class="tip_dialog num_dialog"><div class="t_arrow t_arrow_top"><span></span><i></i></div><p>'+r.msg+"</p>"+'<div class="btn_box">'+'<a href="javascript:;" class="confirm">确定</a>'+"</div>"+"</div>";!$(e).hasClass("input")&&$(e).addClass("unable"),$(".cart_item.unable").find("input").attr("readonly","readonly"),$div.find(".input").val(n.validateNum),$div.find(".input").siblings("input").val(n.num),r.checkPoint!="起购"&&r.checkPoint!="库存紧张"&&($(e).parents(".item_num").append(i),$(".num_dialog").on("click",".confirm",function(){$(".num_dialog").remove(),n.num!=n.validateNum&&exports.editNum(e)}))}else if(r.msg){var i='<div class="tip_dialog num_dialog"><div class="t_arrow t_arrow_top"><span></span><i></i></div><p>'+r.msg+"</p>"+'<div class="btn_box">'+'<a href="javascript:;" class="cancel">取消</a>'+'<a href="javascript:;" class="confirm">继续添加</a>'+"</div>"+"</div>";$(e).parents(".item_num").append(i),$(".num_dialog").on("click",".confirm",function(){$(".num_dialog").remove(),$div.find(".input").val(n.validateNum),exports.editNum(e)}).on("click",".cancel",function(){return $div.find(".input").val(n.num),$(".num_dialog").remove(),!1})}else n.num!=n.validateNum&&exports.editNum(e)}function t(e){var t=e.parents(".cart_prod").find(".check_item");t.data("checkType")!=2&&t.addClass("checked")}$(".cart_item.unable").find("input").attr("readonly","readonly"),$(".num_act").find("input,.add,.minus").off(),$(".num_act").find("input").blur("input propertychange",function(){if($(this).attr("readonly"))return;e(this)}),$(".num_act").find("input").on("input propertychange",function(){var e=$(this).val();e=Math.min(Math.max(parseInt(e.replace(/\D/g,"")|0,10),1),200),$(this).val(e)}),$(".num_act").find(".add").on("click",function(n){function s(){i<200&&i++;var n=r.siblings("input").val(i);e(r),n.val()>1&&r.siblings(".minus").removeClass("unable"),t(r)}if($(this).hasClass("unable"))return!1;var r=$(this),i=parseInt($(this).siblings("input").val());s()}),$(".num_act").find(".minus").on("click",function(){function s(){r--,r==i?n.addClass("unable"):"",n.siblings(".add").removeClass("unable").siblings("input").val(r),e(n),t(n)}if($(this).hasClass("unable"))return!1;var n=$(this),r=parseInt(n.siblings("input").val()),i;n.attr("data-min")?i=parseInt(n.attr("data-min")):i=1,r<=i?n.addClass("unable"):s()})},exports.initSubProductSerialAttr=function(){var e=!0;$(".serial_product").off().on("click",function(t){t.stopPropagation();var n=this;if($(n).hasClass("down")||$(n).siblings(".prop_dialog").html()){newCart.tipShow($(n),$(n).siblings(".prop_dialog"));return}var r=$(this).data("skuId"),i="/cart/opt/series.do?callback=?",s=$.param({id:r,u_source:"yhd"},!0),o=$(this).find(".attributeName").map(function(){return $(this).html()}).get().join("_"),u=o.split("_"),a="";$.getJSON(i,s,function(i){if(utils.isReqSuccess(i)&&i.data.retCode=="1"){var s=i.data.saleProp,o=new Array,f=new Array;if(s!=null)for(var l=1;l<=3;l++){var c=s[l],h=new Array;if(c!=null&&c!=""){var p=new Object;p.attributeId=l,p.attributeName=c;var d=new Array;for(var v=0;v<10;v++){var m=i.data.salePropSeq[l][v];if(m!=null&&m!=""){var g=new Object;g.attributeValueId=v+1,h[v]=v+1,g.attributeValueAlias=m,d[v]=g}}d.length>0&&(p.attributeValueList=d,o[l-1]=p)}f[l-1]=h}e=!0;var y=i.data.newColorSize;for(var b=0;b<y.length;b++)if(y[b].skuId==r){var w="";for(var E=1;E<5;E++)if(y[b][E]!=null&&y[b][E]!=""){w=w+y[b][E]+"_";var S=o[E-1].attributeValueList;for(var x=0;x<S.length;x++)y[b][E]==S[x].attributeValueAlias&&(a=a+S[x].attributeValueId+"_")}u=w.split("_");break}var T=new Object,N=calcUnavailableCoordinate(y,o,a,f,e,this,T),C=doT.template($("#sub_product_serial_dot").html())($.extend(i,{allSerialAttributes:o,curAttr:u,unavailableCoordinate:N}));$(n).siblings(".prop_dialog").html(C),newCart.tipShow($(n),$(n).siblings(".prop_dialog")),$(n).parent().find(".prop_list").children("li").on("click",function(){$(this).hasClass("unable")||$(this).addClass("cur").siblings("li").removeClass("cur"),e=!1,a=$(n).parent().find(".prop_item").map(function(e,t){return $(t).find("li.cur").data("attributeValueId")}).get().join("_")+"_",calcUnavailableCoordinate(y,o,a,f,e,this,T);var t=$(this).parents(".prop_edit").find(".serial_product").data(r).skuId,i,s=$(this).parents(".prop_edit").find(".prop_item").map(function(){return $(this).find("li.cur").data("attributeValueId")}).get().join("_")+"_";T[s]!=null&&T[s]!=""&&(i=T[s]),i!=t?$(this).parents(".prop_edit").find(".confirm").removeClass("unable"):$(this).parents(".prop_edit").find(".confirm").addClass("unable")}),$(n).siblings(".prop_dialog").find(".confirm,.close").on("click",function(){t.stopPropagation(),newCart.initDialog();if($(this).hasClass("confirm")&&!$(this).hasClass("unable")){var e=$(this).parents(".prop_edit").find(".prop_item").map(function(){return $(this).find("li.cur").data("attributeValueId")}).get().join("_")+"_";if(T[e]!=null&&T[e]!="")var n=T[e];var r=$(this).parents(".cart_prod").find(".del_btn").data("deleteId"),i=$.param({deleteId:r},!0),s="/cart/opt/delete.do?callback=?",o=$(this).parents(".cart_prod").find(".input").val();$.getJSON(s,i,function(e){if(utils.isReqSuccess(e)){var t=$.param({pid:n,ptype:"1",pcount:o},!0),r="/cart/opt/add.do?callback=?&"+t;common.ajax({url:r})}})}})}})}),$(".change_free").on("click",function(e){e.stopPropagation();var t=$(this).data("promotionid"),n=window.promotionData[t];if(!n.giftStock){var r=$.map(n.gifts,function(e,t){var n=e.id,r=e.num||1,i="skus["+t++ +"]";return i+".skuId="+n+"&"+i+".num="+r}).join("&");$.ajax({url:"/cart/mod/queryStock.do",type:"get",data:r,dataType:"jsonp",async:!1,success:function(e){if(e.code="00000000"){var t=n.giftStock=e.data;t&&$.each(n.gifts,function(e,n){var r=t[n.id];r?n.hasStock=["33","39","40"].indexOf(r)>=0:n.hasStock=!0})}}})}if(n.type==5)var i=".choose_present",s="#choose_present_dot",o="换购",u="取消换购";else var i=".get_present",s="#get_present_dot",o="领取",u="取消领取";var a=doT.template($(s).html())(n);$(i).html(a),$(".give_present_btn").click(function(){var e=$(this),t=$(".give_present_btn.gived").length;if(e.hasClass("red"))if(n.canSelectGiftNum&&t>=n.canSelectGiftNum){var r=e.siblings(".give_tip");r.text("最多可选择"+n.canSelectGiftNum+"件"),setTimeout(function(){r.text("")},2e3)}else e.removeClass("red"),e.addClass("gived"),e.html(u),t++;else e.addClass("red"),e.removeClass("gived"),e.html(o),t--;$(".give_num").text(t)}),newCart.initDialog(),$(this).PopupDialog({popupClass:i,maskLayer:!1,cancelCallback:function(){exports.ajaxChooseGift($(i),n)}})})},exports.moveToFavorite=function(e){function t(){newCart.alert("您已收藏过该商品",2)}if($(e).hasClass("got")){t();return}var n=$(e).data("productId"),r="/cart/opt/moveToFavorite.do?productId="+n+"&callback=?";$.getJSON(r,function(n){common.reqSucceed(n)&&(n.code=="00000000"?(setTimeout(function(){exports.doDelete({btn:$(e,"1").siblings(".del_btn")})},1500),newCart.animateParabola(e,document.getElementById("collect")),exports.myCollection()):(n.code="00000001")&&t())})},exports.myCollectionProdutIds,exports.myCollection=function(){var e="/cart/mod/myFavorites.do?callback=?";$.getJSON(e,function(e){if(utils.isReqSuccess(e)&&e.data){e.data.list&&e.data.list.length&&(exports.myCollectionProdutIds=[],$(e.data.list).each(function(){exports.myCollectionProdutIds.push(this.productId)}),e.data.list.length>10&&(e.data.list.length=10)),exports.showCollected();var t=doT.template($("#t_panel_cont_favor_dot").html())(e.data);$(".t_panel_cont_favor").find(".t_panel_wrap").html(t),$(".collected_add").on("click",function(){exports.ajaxAddProductToCart($(this).data("productId"))});var n=$(".t_panel_cont_favor").find("li").length;$(".t_warp_slide_tabs").find("#collect").find(".c_lit_tip").html(n),$(".t_panel_cont_favor .ti_name").each(function(){$(this).dotdotdot({wrap:"letter",height:40})})}})},exports.showCollected=function(){if(exports.myCollectionProdutIds&&exports.myCollectionProdutIds.length)for(var e=0;e<exports.myCollectionProdutIds.length;e++)$btn=$(".collect_btn_"+exports.myCollectionProdutIds[e]),$btn.addClass("collected"),$btn.attr("title","已收藏过该商品")},exports.myBoughtItems=function(){var e={page:"1",pageSize:"8"},t="/cart/mod/alwaysBuy.do?callback=?";$.getJSON(t,e,function(e){if(e==null)return;if(common.reqSucceed(e)&&e.data){var t=doT.template($("#dot-boughtItems").html())(e.data);$(".t_panel_cont_list").find(".t_panel_wrap").html(t),$(".bought_add").on("click",function(){exports.ajaxAddProductToCart($(this).data("pmInfoId"))}),$(".t_panel_cont_list .ti_name").each(function(){$(this).dotdotdot({wrap:"letter",height:40})})}})},exports.claimCoupon=function(){var e=$(".quickly_coupon").map(function(){var e=$(this).data("merchantId");return e<=0?null:e}).get();if(!e||!e.length)return;var t=$(e).map(function(){var e=this,t="";return $("#coupon_"+e).parents(".cart_list").find(".item").each(function(e){var n=$(this).data("identifier"),r=window.itemData[n];if(!r)return;var i=r.checkType==1?1:0;t+=r.sku.id+"_"+r.sku.cid+"_"+i+","}),t.length>0&&(t=t.substring(0,t.length-1)),t}).get();if(!t||t.length!=e.length)return;$.getJSON("/cart/opt/getCoupons.do",$.param({venderIds:e,skuCids:t},!0),function(t){t.data&&($(e).each(function(e,n){var r=t.data[n],i=$.grep(r,function(e,t){return e.skuSelected}),s=$.grep(r,function(e,t){return!e.skuSelected});r&&r.length&&$("#coupon_"+n).show().find(".coupon_dialog").html(doT.template($("#claim_coupon_dot").html())({coupons:r,selectedCoupons:i,unselectedCoupons:s,merchantId:n}))}),$(".quickly_coupon").hover(function(){$(".quickly_coupon a").attr("clstag","pageclick|keycount|cart_201709267|24")},function(){$(".quickly_coupon a").removeAttr("clstag")}),$(".claim_coupon").click(function(){var e=this,t=$("#cart_eid").val(),n=$("#cart_fp").val(),r=$("#cart_shshshfp").val(),i=$("#cart_shshshfpa").val(),s=$("#cart_shshshfpb").val(),o=$(e).data("encryptedKey")||"",u=($(".couponName").html()||"").trim(),a="-1";$(".tip_trigger").attr("clstag").length>0&&couponPageClickKeyLog(o,u),$.ajax({url:"/cart/opt/claimCoupon.do?callback=?",type:"POST",dataType:"jsonp",data:{ruleId:$(e).data("ruleId"),key:o,eid:t,fp:n,shshshfp:r,shshshfpa:i,shshshfpb:s,couponPageClickKey:a},success:function(t){utils.isReqSuccess(t)&&t.data?t.data.resultCode==999?$(e).addClass("has_get").removeClass("get").html('<i class="iconfont"></i>已领取').off():t.data.resultCode==400||t.data.resultCode==404||t.data.resultCode==500||t.data.resultCode==503?newCart.alert("领取抵用券失败，请稍后再试",2):newCart.alert(t.data.resultMsg||"领取抵用券失败，请稍后再试",2):newCart.alert("领取抵用券失败，请稍后再试",2)}})}))})},exports.shopData=function(){var e="/cart/opt/getShopData.do",t=$(".cart_tit.clearfix").map(function(){if($(this).data("merchantId")!="8888"&&$(this).data("merchantId")!="8899")return $(this).data("merchantId")}).get().join(","),n={venderList:t};if(n.venderList.length==0)return;$.ajax({url:e,data:n,dataType:"json",success:function(e){if(e.data&&e.data.model){var n=e.data.model;if(n){window.shopinfo=n;var r=0;$(t.split(",")).each(function(e,t){var r=n[e].pcShopUrl;r!=null&&$(".cart_tit.clearfix[data-merchant-id="+t+"]").find(".label.vender").attr("href","//"+r),e++})}}}})},exports.partialLimit=function(){if($.cookie("yhd_location")==null)return;var e="/cart/opt/getSkuPartition.do",t=$(".check_item.normal_item").map(function(){var e=$(this).data("skuId"),t=0;$(this).hasClass("fresh")&&(t=1);var n=$(this).data("skuCategory");return e+"_"+n+"_"+t}).get().join("-");if(t&&t.length>0){var n={skuInfos:t,localId:$.cookie("yhd_location").replace(new RegExp("_","g"),",")};$.ajax({url:e,data:n,dataType:"json",success:function(e){utils.isReqSuccess(e)&&(window.partialData=e.data,$(".item_num").each(function(){e.data&&window.partialData[$(this).data("skuId")]&&(window.partialData[$(this).data("skuId")].saleStatus=="partialsupport"||window.partialData[$(this).data("skuId")].saleStatus=="unsupport")&&($(this).find(".stock").html(""),$(this).find(".partial").html("该商品在该地区暂不支持销售"))}))}})}},exports.doDelete=function(e){var t=e.deleteIds||$(e.btn).data("deleteId");if(!t)return!0;common.ajax({type:"delete",url:"/cart/opt/delete.do?callback=?",deleteId:t,deleteType:0,time:200,success:function(t){if(!e.deleteIds&&utils.isReqSuccess(t)&&e.recycleItemInfo){var n=encodeURIComponent(JSON.stringify(e.recycleItemInfo.itemInfo));$.post("/cart/opt/moveToRecycleBin.do",{itemInfo:n,identifier:e.recycleItemInfo.identifier},function(){exports.shoppingRecycleBin()})}}})},window.recycleBin={},exports.shoppingRecycleBin=function(e){var t="/cart/mod/shoppingRecycleBin.do?callback=?";e&&(t=t+"&identifiers[0]="+e),$.getJSON(t,function(e){if(utils.isReqSuccess(e)&&e.data){var t=doT.template($("#recycler_dot").html())(e.data);$(".t_panel_cont_recycler").find(".t_panel_wrap").html(t),window.recycleBin=null,window.recycleBin={},$(e.data.shoppingRecycleBin).each(function(){window.recycleBin[this.identifier]=this}),$(".recycle_add").off().on("click",function(){var e=$(this).data("identifier"),t=window.recycleBin[e],n=JSON.parse(t.itemInfo);n.num=n.num||1;var r=n.sku.id||n.promotionId,i=n.sku.id==""?2:1;common.ajax({url:"/cart/opt/add.do?pid="+r+"&ptype="+i+"&pcount="+n.num,success:function(t){utils.isReqSuccess(t)&&exports.shoppingRecycleBin(e)}})});var n=$(".t_panel_cont_recycler").find("li").length;$(".t_warp_slide_tabs").find("#trash").find(".c_lit_tip").html(n),n?$(".t_panel_cont_recycler").find(".delete_all").show():$(".t_panel_cont_recycler").find(".delete_all").hide(),$(".t_panel_cont_recycler .ti_name").each(function(){$(this).dotdotdot({wrap:"letter",height:40})})}})},exports.bindItemEvents=function(){$(".cart_item").on("click",".del_btn",function(){var e=this,t=getRecycleItemInfo(e);t?t.isSuit?exports.doDelete({btn:e,recycleItemInfo:t}):(newCart.animateParabola(this,document.getElementById("trash")),setTimeout(function(){exports.doDelete({btn:e,recycleItemInfo:t})},1500)):newCart.dialog({tit:"确认删除",txt:"删除后不可撤销",callback:function(){exports.doDelete({btn:e})}})}),$(".cart_item").on("click",".collect_btn",function(){exports.moveToFavorite(this)}),$(".lt_delete").on("click",function(e){var t=$(".main_item").map(function(){if($(this).find("a.checked").length&&$(this).find(".del_btn").length)return $(this).find(".del_btn").data("deleteId")}).get().join(",");if(!t){newCart.alert("请选择需要删除的商品",1);return}var n=this;newCart.dialog({tit:"批量删除商品",txt:"确定批量删除所选商品吗？",callback:function(){exports.doDelete({btn:n,deleteIds:t})}})}),$(".lt_disable").on("click",function(e){var t=$(".cart_prod.clearfix.unable").map(function(){return $(this).find(".del_btn").data("deleteId")}).get().join(","),n=this;newCart.dialog({tit:"批量清除无效商品",txt:"确定要删除无效商品吗？",callback:function(){exports.doDelete({btn:n,deleteIds:t})}})}),$(".delete_gift").on("click",function(e){e.stopPropagation();var t=$(this).parent().find(".group_gift_self_use").map(function(){return $(this).data("deleteId")}).get().join(","),n=$(this).data("promoid"),r=$(this).data("pid");return newCart.dialog({tit:"确定删除",txt:"确定从购物车中删除吗？",callback:function(){var e=window.promotionData[n],i=[];$.each(e.selectedGifts,function(e,t){t.id!=r&&i.push(t.id)});if(i.length>0){var s="/cart/opt/addGiftsOfMZ.do?pids="+i.join(",")+"&promoId="+n+"&callback=?";common.ajax({url:s})}else common.ajax({type:"delete",url:"/cart/opt/removeGiftsOfMZ.do?promoId="+n+"&callback=?",deleteId:t,deleteType:1,time:200})}}),!1})},exports.refreshMainBody=function(e){if(common.reqSucceed(e)){window.itemData=null,window.itemData={};var t=doT.template($("#cart_main_body_dot").html())(e.data);$("#cart_main_body").replaceWith(t),$("img").one("error",function(){this.src="/statics/shopping/pc/images/defaultproduct_75x75.jpg"}),$(".mainCart.scrollLoading").scrollLoading();var n="{}";e&&e.data&&e.data.cartVo&&(n=e.data.cartVo.allProductIdsStr),common.reloadDelete(),exports.numAct(),exports.initCheckOutBar(e.data),newCart.check(),e.data.login&&exports.claimCoupon(),exports.initSubProductSerialAttr(),exports.payBarBatchChooseGift(),exports.makeUpItem(),exports.loadWarningMessage(),exports.recommendGoods(),!exports.isMedicine&&exports.loadRecommendation(),exports.showCollected(),exports.bindItemEvents(),newCart.tipDialog(),exports.processAreaInfo(),newCart.modAreaSelect(),newCart.initClass(),newCart.otherJs(),newCart.prodHover(),newCart.freeEvents(),newCart.initDialog(),newCart.activityDroplist(),newCart.initPopChat(),exports.partialLimit(),exports.storeCartNum(e.data),exports.triggerYuyueCountdown(),newCart.queryUserGoldNum(),newCart.queryLandingDeliveryInfo();try{window.synccookie.dosync("unpl"),relocateSkuByAnchor()}catch(r){}}},exports.initPrismBar=function(){exports.shoppingRecycleBin(),utils.checkLogin(function(e){e?(exports.myCollection(),exports.myBoughtItems()):$(".tbar_wrap_tabs .t_control_btn").each(function(){var e=$(this).data("value");(e=="list"||e=="favor")&&$(this).hide()})})},relocateSkuByAnchor=function(){var e=window.sessionStorage.getItem("cart_anchor");e&&($("html,body").animate({scrollTop:$("#"+e).offset().top-120},200),window.sessionStorage.removeItem("cart_anchor"))},exports.processAreaInfo=function(){var e="/cart/opt/getAreaInfo.do?callback=?";$.getJSON(e,function(e){$("#cart_province_id").val(e.data.currProvinceId),$("#cart_province_name").val(e.data.currProvinceName),$("#cart_city_id").val(e.data.currCityId),$("#cart_city_name").val(e.data.currCityName),$("#cart_county_id").val(e.data.currCountyId),$("#cart_county_name").val(e.data.currCountyName),newCart.areaInit()})},exports.initMainBody=function(){var e="/cart/mod/newMainbody.do?callback=?";common.blockUI(),$.getJSON(e,function(e){exports.refreshMainBody(e),common.unblockUI(),$(".mainCart.scrollLoading").scrollLoading()})},exports.reloadMainBody=function(){var e="/cart/mod/newMainbody.do?callback=?";$.getJSON(e,function(e){exports.refreshMainBody(e)})},exports.storeCartNum=function(e){e&&$.cookie("cart_num",e.allItemNum||0,{path:"/",domain:".yhd.com"})},exports.triggerYuyueCountdown=function(){var e;$(".countdown").each(function(){$(this).data("ellapsed")?($(this).text("00:00:00"),e=!0):$(this).countdown({time:$(this).data("time")*1e3,onTick:function(e,t,n,r){e.html(t+":"+n+":"+r)},onExpiry:function(){setTimeout(function(){exports.reloadMainBody()},1e3)}})}),e&&setTimeout(function(){exports.reloadMainBody()},2e3)},exports.init=function(){exports.isMedicine=!!$("#isMedicine").val(),exports.initMainBody(),exports.initPrismBar(),newCart.toolbar()},exports}),define("searchBar",["jquery"],function(e){var t={};return t.areaInit=function(){function t(t,n,r,i){var s=e("#keyword"),o="//search.yhd.com";t?t instanceof jQuery&&(s=t,t=s.val()):t=s.val(),t=t.replace(/\//gi," ");if(!t||t=="请输入关键词")return;var u="0";e("#leaf").size()>0&&(u=e("#leaf").val());if(i){var a=o+"/c0-0-0/b/a-s1-v2-p1-price-d0-f0b-m1-rt0-pid-mid0-k"+encodeURIComponent(encodeURIComponent(t))+"/";loli.spm.refreshPage(a,s);return}var f=e("#recommendId").val(),l=e("#recommendName").val();if(n!=null&&n!="0"){var a=o+"/c"+n+"-"+r+"/k"+encodeURIComponent(encodeURIComponent(t))+"/";loli.spm.openPage(s,a)}else if(f!=null&&f!=""){var a=o+"/c"+f+"-"+l+"/k"+encodeURIComponent(encodeURIComponent(t))+"/";loli.spm.openPage(s,a)}else{var a=o+"/c"+u+"-0/k"+encodeURIComponent(encodeURIComponent(t))+"/";loli.spm.openPage(s,a)}}e("#keyword").keydown(function(e){e=e||window.event;var n=e.keyCode;n=="13"&&t()}),e("#search").click(function(){t()})},t.init=function(){this.areaInit()},t}),function(e){e.fn.scrollLoading=function(t){var n={attr:"data-url",container:e(window),callback:e.noop},r=e.extend({},n,t||{});r.cache=[],e(this).each(function(){var t=this.nodeName.toLowerCase(),n=e(this).attr(r.attr),i={obj:e(this),tag:t,url:n};r.cache.push(i)});var i=function(t){e.isFunction(r.callback)&&r.callback.call(t.get(0))},s=function(){var t=r.container.height();r.container.get(0)===window?contop=e(window).scrollTop():contop=r.container.offset().top,e.each(r.cache,function(e,n){var r=n.obj,s=n.tag,o=n.url,u,a;if(r){u=r.offset().top-contop,a=u+r.height();if(u>=0&&u<t||a>0&&a<=t)o?s==="img"?i(r.attr("src",o)):r.load(o,{},function(){i(r)}):i(r),n.obj=null}})};s(),r.container.bind("scroll",s)}}(jQuery),define("scrollLoading",function(){}),requirejs.config({baseUrl:"/statics/shopping/",paths:{scrollLoading:"pc/js/lib/jquery.scrollLoading-min",dotdotdot:"pc/js/lib/jquery.dotdotdot.min",doT:"common/js/doT",blockUI:"pc/js/lib/jquery.blockUI",countdown:"pc/js/lib/countdown",scroll:"pc/js/lib/scroll",dialog:"pc/js/lib/dialog",parabola:"pc/js/lib/parabola",newCart:"pc/js/newCart",searchBar:"pc/js/search_bar_cart",common:"pc/js/cart_common",utils:"pc/js/cart_utils",WebIM:"pc/js/WebIM",cart_main_body:"pc/js/cart_main_body"},shim:{dialog:["jquery"],scroll:["jquery"]}}),requirejs(["cart_main_body","searchBar","scrollLoading"],function(e,t){e.init(),t.init()}),define("pc/js/cart_config",function(){});